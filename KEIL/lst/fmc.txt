; generated by Component: ARM Compiler 5.06 update 4 (build 422) Tool: ArmCC [4d3604]
; commandline ArmCC [--c99 --list --split_sections --debug -c --asm --interleave -o.\obj\fmc.o --asm_dir=.\lst\ --list_dir=.\lst\ --depend=.\obj\fmc.d --cpu=Cortex-M4.fp --apcs=interwork -O3 --diag_suppress=9931 -I..\..\..\..\Library\Device\Nuvoton\M480\Include -I..\..\..\..\Library\StdDriver\inc -I..\..\..\..\ThirdParty\emWin\Config -I..\..\..\..\ThirdParty\emWin\Include -I..\tslib -I..\..\..\..\Library\CMSIS\Include -I..\Thermostat -I..\Application\Source\Generated -IC:\Keil_v5\ARM\RV31\INC -IC:\Keil_v5\ARM\CMSIS\Include -D__UVISION_VERSION=523 --omf_browse=.\obj\fmc.crf ..\..\..\..\Library\StdDriver\src\fmc.c]
                          THUMB

                          AREA ||i.FMC_CheckAllOne||, CODE, READONLY, ALIGN=2

                  FMC_CheckAllOne PROC
;;;1090     */
;;;1091   uint32_t  FMC_CheckAllOne(uint32_t u32addr, uint32_t u32count)
000000  b5f0              PUSH     {r4-r7,lr}
;;;1092   {
;;;1093       int32_t  tout;
;;;1094   
;;;1095       g_FMC_i32ErrCode = 0;
000002  4b1d              LDR      r3,|L1.120|
000004  4604              MOV      r4,r0                 ;1092
000006  2000              MOVS     r0,#0
;;;1096   
;;;1097       FMC->ISPSTS = 0x80UL;   /* clear check all one bit */
000008  4a1c              LDR      r2,|L1.124|
00000a  6018              STR      r0,[r3,#0]  ; g_FMC_i32ErrCode
00000c  2080              MOVS     r0,#0x80
00000e  6410              STR      r0,[r2,#0x40]
;;;1098   
;;;1099       FMC->ISPCMD   = FMC_ISPCMD_RUN_ALL1;
000010  2028              MOVS     r0,#0x28
000012  60d0              STR      r0,[r2,#0xc]
;;;1100       FMC->ISPADDR  = u32addr;
000014  6054              STR      r4,[r2,#4]
;;;1101       FMC->ISPDAT   = u32count;
000016  6091              STR      r1,[r2,#8]
;;;1102       FMC->ISPTRG   = FMC_ISPTRG_ISPGO_Msk;
000018  2501              MOVS     r5,#1
00001a  6115              STR      r5,[r2,#0x10]
;;;1103   
;;;1104       tout = FMC_TIMEOUT_CHKALLONE;
00001c  4818              LDR      r0,|L1.128|
00001e  6800              LDR      r0,[r0,#0]  ; SystemCoreClock
000020  0041              LSLS     r1,r0,#1
000022  460e              MOV      r6,r1
                  |L1.36|
;;;1105       while ((tout-- > 0) && (FMC->MPSTS & FMC_MPSTS_MPBUSY_Msk)) {}
000024  1e30              SUBS     r0,r6,#0
000026  f1a60601          SUB      r6,r6,#1
00002a  dd03              BLE      |L1.52|
00002c  f8d200c0          LDR      r0,[r2,#0xc0]
000030  07c0              LSLS     r0,r0,#31
000032  d1f7              BNE      |L1.36|
                  |L1.52|
;;;1106       if (tout <= 0)
;;;1107       {
;;;1108           g_FMC_i32ErrCode = -1;
000034  f04f30ff          MOV      r0,#0xffffffff
000038  2e00              CMP      r6,#0                 ;1106
00003a  dd1a              BLE      |L1.114|
;;;1109           return READ_ALLONE_CMD_FAIL;
;;;1110       }
;;;1111   
;;;1112       tout = FMC_TIMEOUT_CHKALLONE;
;;;1113       do
;;;1114       {
;;;1115           FMC->ISPCMD = FMC_ISPCMD_READ_ALL1;
00003c  2608              MOVS     r6,#8
                  |L1.62|
00003e  60d6              STR      r6,[r2,#0xc]
;;;1116           FMC->ISPADDR    = u32addr;
000040  6054              STR      r4,[r2,#4]
;;;1117           FMC->ISPTRG = FMC_ISPTRG_ISPGO_Msk;
000042  6115              STR      r5,[r2,#0x10]
                  |L1.68|
;;;1118           while ((tout-- > 0) && (FMC->MPSTS & FMC_MPSTS_MPBUSY_Msk)) {}
000044  1e0f              SUBS     r7,r1,#0
000046  f1a10101          SUB      r1,r1,#1
00004a  dd03              BLE      |L1.84|
00004c  f8d270c0          LDR      r7,[r2,#0xc0]
000050  07ff              LSLS     r7,r7,#31
000052  d1f7              BNE      |L1.68|
                  |L1.84|
;;;1119           if (tout <= 0)
000054  2900              CMP      r1,#0
000056  dd0c              BLE      |L1.114|
;;;1120           {
;;;1121               g_FMC_i32ErrCode = -1;
;;;1122               return READ_ALLONE_CMD_FAIL;
;;;1123           }
;;;1124       }
;;;1125       while (FMC->ISPDAT == 0UL);
000058  6897              LDR      r7,[r2,#8]
00005a  2f00              CMP      r7,#0
00005c  d0ef              BEQ      |L1.62|
;;;1126   
;;;1127       if ((FMC->ISPDAT == READ_ALLONE_YES) || (FMC->ISPDAT == READ_ALLONE_NOT))
00005e  6891              LDR      r1,[r2,#8]
000060  4c08              LDR      r4,|L1.132|
000062  42a1              CMP      r1,r4
000064  d003              BEQ      |L1.110|
000066  6891              LDR      r1,[r2,#8]
000068  4c07              LDR      r4,|L1.136|
00006a  42a1              CMP      r1,r4
00006c  d101              BNE      |L1.114|
                  |L1.110|
;;;1128           return FMC->ISPDAT;
00006e  6890              LDR      r0,[r2,#8]
;;;1129       else
;;;1130       {
;;;1131           g_FMC_i32ErrCode = -1;
;;;1132           return READ_ALLONE_CMD_FAIL;
;;;1133       }
;;;1134   }
000070  bdf0              POP      {r4-r7,pc}
                  |L1.114|
000072  6018              STR      r0,[r3,#0]            ;1131  ; g_FMC_i32ErrCode
000074  bdf0              POP      {r4-r7,pc}
;;;1135   
                          ENDP

000076  0000              DCW      0x0000
                  |L1.120|
                          DCD      ||.data||
                  |L1.124|
                          DCD      0x4000c000
                  |L1.128|
                          DCD      SystemCoreClock
                  |L1.132|
                          DCD      0xa11fffff
                  |L1.136|
                          DCD      0xa1100000

                          AREA ||i.FMC_Close||, CODE, READONLY, ALIGN=2

                  FMC_Close PROC
;;;34       */
;;;35     void FMC_Close(void)
000000  4802              LDR      r0,|L2.12|
;;;36     {
;;;37         FMC->ISPCTL &= ~FMC_ISPCTL_ISPEN_Msk;
000002  6801              LDR      r1,[r0,#0]
000004  f0210101          BIC      r1,r1,#1
000008  6001              STR      r1,[r0,#0]
;;;38     }
00000a  4770              BX       lr
;;;39     
                          ENDP

                  |L2.12|
                          DCD      0x4000c000

                          AREA ||i.FMC_CompareSPKey||, CODE, READONLY, ALIGN=2

                  FMC_CompareSPKey PROC
;;;1256     */
;;;1257   int32_t  FMC_CompareSPKey(uint32_t key[3])
000000  4a1b              LDR      r2,|L3.112|
;;;1258   {
;;;1259       uint32_t  u32KeySts;
;;;1260       int32_t   tout;
;;;1261   
;;;1262       g_FMC_i32ErrCode = 0;
000002  2100              MOVS     r1,#0
;;;1263   
;;;1264       if (FMC->KPKEYSTS & FMC_KPKEYSTS_FORBID_Msk)
000004  6011              STR      r1,[r2,#0]  ; g_FMC_i32ErrCode
000006  491b              LDR      r1,|L3.116|
000008  6e0b              LDR      r3,[r1,#0x60]
00000a  071b              LSLS     r3,r3,#28
00000c  d502              BPL      |L3.20|
;;;1265       {
;;;1266           /* FMC_CompareSPKey - FORBID!  */
;;;1267           g_FMC_i32ErrCode = -2;
00000e  f06f0001          MVN      r0,#1
;;;1268           return -2;
000012  e029              B        |L3.104|
                  |L3.20|
;;;1269       }
;;;1270   
;;;1271       if (!(FMC->KPKEYSTS & FMC_KPKEYSTS_KEYLOCK_Msk))
000014  6e0b              LDR      r3,[r1,#0x60]
000016  079b              LSLS     r3,r3,#30
000018  d402              BMI      |L3.32|
;;;1272       {
;;;1273           /* FMC_CompareSPKey - key is not locked!  */
;;;1274           g_FMC_i32ErrCode = -4;
00001a  f06f0003          MVN      r0,#3
;;;1275           return -4;
00001e  e023              B        |L3.104|
                  |L3.32|
;;;1276       }
;;;1277   
;;;1278       FMC->KPKEY0 = key[0];
000020  6803              LDR      r3,[r0,#0]
000022  650b              STR      r3,[r1,#0x50]
;;;1279       FMC->KPKEY1 = key[1];
000024  6843              LDR      r3,[r0,#4]
000026  654b              STR      r3,[r1,#0x54]
;;;1280       FMC->KPKEY2 = key[2];
000028  6880              LDR      r0,[r0,#8]
00002a  6588              STR      r0,[r1,#0x58]
;;;1281       FMC->KPKEYTRG = FMC_KPKEYTRG_KPKEYGO_Msk | FMC_KPKEYTRG_TCEN_Msk;
00002c  2003              MOVS     r0,#3
00002e  65c8              STR      r0,[r1,#0x5c]
;;;1282   
;;;1283       tout = FMC_TIMEOUT_READ;
000030  4811              LDR      r0,|L3.120|
000032  230a              MOVS     r3,#0xa
000034  6800              LDR      r0,[r0,#0]  ; SystemCoreClock
000036  fbb0f0f3          UDIV     r0,r0,r3
00003a  0040              LSLS     r0,r0,#1
                  |L3.60|
;;;1284       while ((tout-- > 0) && (FMC->KPKEYSTS & FMC_KPKEYSTS_KEYBUSY_Msk)) {}
00003c  1e03              SUBS     r3,r0,#0
00003e  f1a00001          SUB      r0,r0,#1
000042  dd02              BLE      |L3.74|
000044  6e0b              LDR      r3,[r1,#0x60]
000046  07db              LSLS     r3,r3,#31
000048  d1f8              BNE      |L3.60|
                  |L3.74|
;;;1285       if (tout <= 0)
00004a  2800              CMP      r0,#0
00004c  dc02              BGT      |L3.84|
;;;1286       {
;;;1287           g_FMC_i32ErrCode = -1;
00004e  f04f30ff          MOV      r0,#0xffffffff
;;;1288           return -1;
000052  e009              B        |L3.104|
                  |L3.84|
;;;1289       }
;;;1290   
;;;1291       u32KeySts = FMC->KPKEYSTS;
000054  6e08              LDR      r0,[r1,#0x60]
;;;1292   
;;;1293       if (!(u32KeySts & FMC_KPKEYSTS_KEYMATCH_Msk))
000056  0741              LSLS     r1,r0,#29
000058  d402              BMI      |L3.96|
;;;1294       {
;;;1295           /* Key mismatched! */
;;;1296           g_FMC_i32ErrCode = -3;
00005a  f06f0002          MVN      r0,#2
;;;1297           return -3;
00005e  e003              B        |L3.104|
                  |L3.96|
;;;1298       }
;;;1299       else if (u32KeySts & FMC_KPKEYSTS_KEYLOCK_Msk)
000060  0780              LSLS     r0,r0,#30
000062  d503              BPL      |L3.108|
;;;1300       {
;;;1301           /* Key matched, but failed to unlock! */
;;;1302           g_FMC_i32ErrCode = -5;
000064  f06f0004          MVN      r0,#4
                  |L3.104|
000068  6010              STR      r0,[r2,#0]  ; g_FMC_i32ErrCode
;;;1303           return -5;
;;;1304       }
;;;1305       return 0;
;;;1306   }
00006a  4770              BX       lr
                  |L3.108|
00006c  2000              MOVS     r0,#0                 ;1305
00006e  4770              BX       lr
;;;1307   
                          ENDP

                  |L3.112|
                          DCD      ||.data||
                  |L3.116|
                          DCD      0x4000c000
                  |L3.120|
                          DCD      SystemCoreClock

                          AREA ||i.FMC_ConfigXOM||, CODE, READONLY, ALIGN=2

                  FMC_ConfigXOM PROC
;;;55       */
;;;56     int32_t FMC_ConfigXOM(uint32_t u32XomNum, uint32_t u32XomBase, uint8_t u8XomPage)
000000  e92d47f0          PUSH     {r4-r10,lr}
;;;57     {
;;;58         int32_t   tout;
;;;59         int32_t   ret;
;;;60     
;;;61         g_FMC_i32ErrCode = 0;
000004  4c39              LDR      r4,|L4.236|
000006  f04f0a00          MOV      r10,#0
00000a  4691              MOV      r9,r2                 ;57
00000c  460f              MOV      r7,r1                 ;57
00000e  4605              MOV      r5,r0                 ;57
;;;62     
;;;63         if (u32XomNum >= 4UL)
000010  f8c4a000          STR      r10,[r4,#0]  ; g_FMC_i32ErrCode
000014  2804              CMP      r0,#4
000016  d302              BCC      |L4.30|
;;;64         {
;;;65             g_FMC_i32ErrCode = -2;
000018  f06f0001          MVN      r0,#1
;;;66             return -2;
00001c  e05d              B        |L4.218|
                  |L4.30|
;;;67         }
;;;68     
;;;69         ret = FMC_GetXOMState(u32XomNum);
00001e  4628              MOV      r0,r5
000020  f7fffffe          BL       FMC_GetXOMState
;;;70         if (ret != 0)
000024  2800              CMP      r0,#0
000026  d159              BNE      |L4.220|
;;;71             return ret;
;;;72     
;;;73         FMC->ISPCMD = FMC_ISPCMD_PROGRAM;
000028  4b31              LDR      r3,|L4.240|
00002a  2621              MOVS     r6,#0x21
00002c  60de              STR      r6,[r3,#0xc]
;;;74         FMC->ISPADDR = FMC_XOM_BASE + (u32XomNum * 0x10u);
00002e  f44f1000          MOV      r0,#0x200000
000032  eb001005          ADD      r0,r0,r5,LSL #4
000036  6058              STR      r0,[r3,#4]
;;;75         FMC->ISPDAT = u32XomBase;
000038  609f              STR      r7,[r3,#8]
;;;76         FMC->ISPTRG = FMC_ISPTRG_ISPGO_Msk;
00003a  2101              MOVS     r1,#1
00003c  6119              STR      r1,[r3,#0x10]
;;;77         tout = FMC_TIMEOUT_WRITE;
00003e  482d              LDR      r0,|L4.244|
000040  270a              MOVS     r7,#0xa
000042  f8d0c000          LDR      r12,[r0,#0]  ; SystemCoreClock
000046  fbbcf0f7          UDIV     r0,r12,r7
00004a  0042              LSLS     r2,r0,#1
                  |L4.76|
;;;78         while ((tout-- > 0) && (FMC->MPSTS & FMC_MPSTS_MPBUSY_Msk)) {}
00004c  1e10              SUBS     r0,r2,#0
00004e  f1a20201          SUB      r2,r2,#1
000052  dd03              BLE      |L4.92|
000054  f8d300c0          LDR      r0,[r3,#0xc0]
000058  07c0              LSLS     r0,r0,#31
00005a  d1f7              BNE      |L4.76|
                  |L4.92|
;;;79         if (tout <= 0)
;;;80         {
;;;81             g_FMC_i32ErrCode = -1;
00005c  f04f30ff          MOV      r0,#0xffffffff
000060  2a00              CMP      r2,#0                 ;79
000062  dd3a              BLE      |L4.218|
;;;82             return -1;
;;;83         }
;;;84     
;;;85         if (FMC->ISPSTS & FMC_ISPSTS_ISPFF_Msk)
000064  6c1a              LDR      r2,[r3,#0x40]
000066  0652              LSLS     r2,r2,#25
000068  d504              BPL      |L4.116|
                  |L4.106|
;;;86         {
;;;87             FMC->ISPSTS |= FMC_ISPSTS_ISPFF_Msk;
00006a  6c19              LDR      r1,[r3,#0x40]
00006c  f0410140          ORR      r1,r1,#0x40
000070  6419              STR      r1,[r3,#0x40]
;;;88             g_FMC_i32ErrCode = -1;
;;;89             return -1;
000072  e032              B        |L4.218|
                  |L4.116|
;;;90         }
;;;91     
;;;92         FMC->ISPCMD = FMC_ISPCMD_PROGRAM;
000074  60de              STR      r6,[r3,#0xc]
;;;93         FMC->ISPADDR = FMC_XOM_BASE + (u32XomNum * 0x10u + 0x04u);
000076  f8df8080          LDR      r8,|L4.248|
00007a  eb081805          ADD      r8,r8,r5,LSL #4
00007e  f8c38004          STR      r8,[r3,#4]
;;;94         FMC->ISPDAT = u8XomPage;
000082  f8c39008          STR      r9,[r3,#8]
;;;95         FMC->ISPTRG = FMC_ISPTRG_ISPGO_Msk;
000086  6119              STR      r1,[r3,#0x10]
;;;96         tout = FMC_TIMEOUT_WRITE;
000088  fbbcf2f7          UDIV     r2,r12,r7
00008c  ea5f0242          LSLS.W   r2,r2,#1
                  |L4.144|
;;;97         while ((tout-- > 0) && (FMC->MPSTS & FMC_MPSTS_MPBUSY_Msk)) {}
000090  f1b20800          SUBS     r8,r2,#0
000094  f1a20201          SUB      r2,r2,#1
000098  dd04              BLE      |L4.164|
00009a  f8d380c0          LDR      r8,[r3,#0xc0]
00009e  ea5f78c8          LSLS     r8,r8,#31
0000a2  d1f5              BNE      |L4.144|
                  |L4.164|
;;;98         if (tout <= 0)
0000a4  2a00              CMP      r2,#0
0000a6  dd18              BLE      |L4.218|
;;;99         {
;;;100            g_FMC_i32ErrCode = -1;
;;;101            return -1;
;;;102        }
;;;103    
;;;104        if(FMC->ISPSTS & FMC_ISPSTS_ISPFF_Msk)
0000a8  6c1a              LDR      r2,[r3,#0x40]
0000aa  0652              LSLS     r2,r2,#25
0000ac  d4dd              BMI      |L4.106|
;;;105        {
;;;106            FMC->ISPSTS |= FMC_ISPSTS_ISPFF_Msk;
;;;107            g_FMC_i32ErrCode = -1;
;;;108            return -1;
;;;109        }
;;;110    
;;;111        FMC->ISPCMD = FMC_ISPCMD_PROGRAM;
0000ae  60de              STR      r6,[r3,#0xc]
;;;112        FMC->ISPADDR = FMC_XOM_BASE + (u32XomNum * 0x10u + 0x08u);
0000b0  4a11              LDR      r2,|L4.248|
0000b2  1d12              ADDS     r2,r2,#4
0000b4  eb021205          ADD      r2,r2,r5,LSL #4
0000b8  605a              STR      r2,[r3,#4]
;;;113        FMC->ISPDAT = 0u;
0000ba  f8c3a008          STR      r10,[r3,#8]
;;;114        FMC->ISPTRG = FMC_ISPTRG_ISPGO_Msk;
0000be  6119              STR      r1,[r3,#0x10]
;;;115        tout = FMC_TIMEOUT_WRITE;
0000c0  fbbcf1f7          UDIV     r1,r12,r7
0000c4  0049              LSLS     r1,r1,#1
                  |L4.198|
;;;116        while ((tout-- > 0) && (FMC->MPSTS & FMC_MPSTS_MPBUSY_Msk)) {}
0000c6  1e0a              SUBS     r2,r1,#0
0000c8  f1a10101          SUB      r1,r1,#1
0000cc  dd03              BLE      |L4.214|
0000ce  f8d320c0          LDR      r2,[r3,#0xc0]
0000d2  07d2              LSLS     r2,r2,#31
0000d4  d1f7              BNE      |L4.198|
                  |L4.214|
;;;117        if (tout <= 0)
0000d6  2900              CMP      r1,#0
0000d8  dc02              BGT      |L4.224|
                  |L4.218|
;;;118        {
;;;119            g_FMC_i32ErrCode = -1;
;;;120            return -1;
0000da  6020              STR      r0,[r4,#0]  ; g_FMC_i32ErrCode
                  |L4.220|
;;;121        }
;;;122    
;;;123        if(FMC->ISPSTS & FMC_ISPSTS_ISPFF_Msk)
;;;124        {
;;;125            FMC->ISPSTS |= FMC_ISPSTS_ISPFF_Msk;
;;;126            g_FMC_i32ErrCode = -1;
;;;127            return -1;
;;;128        }
;;;129        return 0;
;;;130    }
0000dc  e8bd87f0          POP      {r4-r10,pc}
                  |L4.224|
0000e0  6c19              LDR      r1,[r3,#0x40]         ;123
0000e2  0649              LSLS     r1,r1,#25             ;123
0000e4  d4c1              BMI      |L4.106|
0000e6  2000              MOVS     r0,#0                 ;129
0000e8  e7f8              B        |L4.220|
;;;131    
                          ENDP

0000ea  0000              DCW      0x0000
                  |L4.236|
                          DCD      ||.data||
                  |L4.240|
                          DCD      0x4000c000
                  |L4.244|
                          DCD      SystemCoreClock
                  |L4.248|
                          DCD      0x00200004

                          AREA ||i.FMC_Erase||, CODE, READONLY, ALIGN=2

                  FMC_Erase PROC
;;;142      */
;;;143    int32_t FMC_Erase(uint32_t u32PageAddr)
000000  4b15              LDR      r3,|L5.88|
;;;144    {
;;;145        int32_t  tout;
;;;146    
;;;147        g_FMC_i32ErrCode = 0;
000002  2100              MOVS     r1,#0
;;;148    
;;;149        if (u32PageAddr == FMC_SPROM_BASE)
000004  f5b01f00          CMP      r0,#0x200000
000008  6019              STR      r1,[r3,#0]  ; g_FMC_i32ErrCode
00000a  d019              BEQ      |L5.64|
;;;150        {
;;;151            return FMC_Erase_SPROM();
;;;152        }
;;;153    
;;;154        FMC->ISPCMD = FMC_ISPCMD_PAGE_ERASE;
00000c  4a13              LDR      r2,|L5.92|
00000e  2122              MOVS     r1,#0x22
000010  60d1              STR      r1,[r2,#0xc]
;;;155        FMC->ISPADDR = u32PageAddr;
000012  6050              STR      r0,[r2,#4]
;;;156        FMC->ISPTRG = FMC_ISPTRG_ISPGO_Msk;
000014  2001              MOVS     r0,#1
000016  6110              STR      r0,[r2,#0x10]
;;;157    
;;;158        tout = FMC_TIMEOUT_ERASE;
000018  4811              LDR      r0,|L5.96|
00001a  210a              MOVS     r1,#0xa
00001c  6800              LDR      r0,[r0,#0]  ; SystemCoreClock
00001e  fbb0f0f1          UDIV     r0,r0,r1
000022  0081              LSLS     r1,r0,#2
                  |L5.36|
;;;159        while ((tout-- > 0) && (FMC->MPSTS & FMC_MPSTS_MPBUSY_Msk)) {}
000024  1e08              SUBS     r0,r1,#0
000026  f1a10101          SUB      r1,r1,#1
00002a  dd03              BLE      |L5.52|
00002c  f8d200c0          LDR      r0,[r2,#0xc0]
000030  07c0              LSLS     r0,r0,#31
000032  d1f7              BNE      |L5.36|
                  |L5.52|
;;;160        if (tout <= 0)
;;;161        {
;;;162            g_FMC_i32ErrCode = -1;
000034  f04f30ff          MOV      r0,#0xffffffff
000038  2900              CMP      r1,#0                 ;160
00003a  dc03              BGT      |L5.68|
                  |L5.60|
;;;163            return -1;
00003c  6018              STR      r0,[r3,#0]  ; g_FMC_i32ErrCode
;;;164        }
;;;165    
;;;166        if (FMC->ISPCTL & FMC_ISPCTL_ISPFF_Msk)
;;;167        {
;;;168            FMC->ISPCTL |= FMC_ISPCTL_ISPFF_Msk;
;;;169            g_FMC_i32ErrCode = -1;
;;;170            return -1;
;;;171        }
;;;172        return 0;
;;;173    }
00003e  4770              BX       lr
                  |L5.64|
000040  f7ffbffe          B.W      FMC_Erase_SPROM
                  |L5.68|
000044  6811              LDR      r1,[r2,#0]            ;166
000046  0649              LSLS     r1,r1,#25             ;166
000048  d504              BPL      |L5.84|
00004a  6811              LDR      r1,[r2,#0]            ;168
00004c  f0410140          ORR      r1,r1,#0x40           ;168
000050  6011              STR      r1,[r2,#0]            ;168
000052  e7f3              B        |L5.60|
                  |L5.84|
000054  2000              MOVS     r0,#0                 ;172
000056  4770              BX       lr
;;;174    
                          ENDP

                  |L5.88|
                          DCD      ||.data||
                  |L5.92|
                          DCD      0x4000c000
                  |L5.96|
                          DCD      SystemCoreClock

                          AREA ||i.FMC_EraseXOM||, CODE, READONLY, ALIGN=2

                  FMC_EraseXOM PROC
;;;300      */
;;;301    int32_t FMC_EraseXOM(uint32_t u32XomNum)
000000  b530              PUSH     {r4,r5,lr}
;;;302    {
;;;303        uint32_t  u32Addr;
;;;304        int32_t   i32Active, err = 0;
000002  2300              MOVS     r3,#0
000004  4605              MOV      r5,r0                 ;302
;;;305        int32_t   tout;
;;;306    
;;;307        if(u32XomNum >= 4UL)
000006  2804              CMP      r0,#4
000008  d301              BCC      |L6.14|
;;;308        {
;;;309            err = -2;
00000a  1e9b              SUBS     r3,r3,#2
00000c  e032              B        |L6.116|
                  |L6.14|
;;;310        }
;;;311    
;;;312        if (err == 0)
;;;313        {
;;;314            i32Active = FMC_GetXOMState(u32XomNum);
00000e  f7fffffe          BL       FMC_GetXOMState
;;;315    
;;;316            if(i32Active)
;;;317            {
;;;318                switch(u32XomNum)
;;;319                {
;;;320                case 0u:
;;;321                    u32Addr = (FMC->XOMR0STS & 0xFFFFFF00u) >> 8u;
;;;322                    break;
;;;323                case 1u:
;;;324                    u32Addr = (FMC->XOMR1STS & 0xFFFFFF00u) >> 8u;
;;;325                    break;
;;;326                case 2u:
;;;327                    u32Addr = (FMC->XOMR2STS & 0xFFFFFF00u) >> 8u;
;;;328                    break;
;;;329                case 3u:
;;;330                    u32Addr = (FMC->XOMR3STS & 0xFFFFFF00u) >> 8u;
;;;331                    break;
;;;332                default:
;;;333                    break;
;;;334                }
;;;335                FMC->ISPCMD = FMC_ISPCMD_PAGE_ERASE;
;;;336                FMC->ISPADDR = u32Addr;
;;;337                FMC->ISPDAT = 0x55aa03u;
;;;338                FMC->ISPTRG = 0x1u;
;;;339    #if ISBEN
;;;340                __ISB();
;;;341    #endif
;;;342                tout = FMC_TIMEOUT_ERASE;
;;;343                while ((tout-- > 0) && FMC->ISPTRG) {}
;;;344                if (tout <= 0)
;;;345                    err = -1;
000012  f04f32ff          MOV      r2,#0xffffffff
000016  b360              CBZ      r0,|L6.114|
000018  491b              LDR      r1,|L6.136|
00001a  b135              CBZ      r5,|L6.42|
00001c  2d01              CMP      r5,#1                 ;318
00001e  d007              BEQ      |L6.48|
000020  2d02              CMP      r5,#2                 ;318
000022  d02b              BEQ      |L6.124|
000024  2d03              CMP      r5,#3                 ;318
000026  d106              BNE      |L6.54|
000028  e02b              B        |L6.130|
                  |L6.42|
00002a  f8d100d0          LDR      r0,[r1,#0xd0]         ;321
00002e  e001              B        |L6.52|
                  |L6.48|
000030  f8d100d4          LDR      r0,[r1,#0xd4]         ;324
                  |L6.52|
000034  0a04              LSRS     r4,r0,#8              ;321
                  |L6.54|
000036  2022              MOVS     r0,#0x22              ;335
000038  60c8              STR      r0,[r1,#0xc]          ;335
00003a  604c              STR      r4,[r1,#4]            ;336
00003c  4813              LDR      r0,|L6.140|
00003e  6088              STR      r0,[r1,#8]            ;337
000040  2001              MOVS     r0,#1                 ;338
000042  6108              STR      r0,[r1,#0x10]         ;338
000044  4812              LDR      r0,|L6.144|
000046  240a              MOVS     r4,#0xa               ;342
000048  6800              LDR      r0,[r0,#0]            ;342  ; SystemCoreClock
00004a  fbb0f0f4          UDIV     r0,r0,r4              ;342
00004e  0080              LSLS     r0,r0,#2              ;342
                  |L6.80|
000050  1e04              SUBS     r4,r0,#0              ;343
000052  f1a00001          SUB      r0,r0,#1              ;343
000056  dd02              BLE      |L6.94|
000058  690c              LDR      r4,[r1,#0x10]         ;343
00005a  2c00              CMP      r4,#0                 ;343
00005c  d1f8              BNE      |L6.80|
                  |L6.94|
00005e  2800              CMP      r0,#0                 ;344
000060  dc00              BGT      |L6.100|
000062  4613              MOV      r3,r2
                  |L6.100|
;;;346    
;;;347                /* Check ISPFF flag to know whether erase OK or fail. */
;;;348                if(FMC->ISPCTL & FMC_ISPCTL_ISPFF_Msk)
000064  6808              LDR      r0,[r1,#0]
000066  0640              LSLS     r0,r0,#25
000068  d504              BPL      |L6.116|
;;;349                {
;;;350                    FMC->ISPCTL |= FMC_ISPCTL_ISPFF_Msk;
00006a  6808              LDR      r0,[r1,#0]
00006c  f0400040          ORR      r0,r0,#0x40
000070  6008              STR      r0,[r1,#0]
                  |L6.114|
;;;351                    err = -1;
;;;352                }
;;;353            }
;;;354            else
;;;355            {
;;;356                err = -1;
000072  4613              MOV      r3,r2
                  |L6.116|
;;;357            }
;;;358        }
;;;359        g_FMC_i32ErrCode = err;
000074  4807              LDR      r0,|L6.148|
;;;360        return err;
000076  6003              STR      r3,[r0,#0]  ; g_FMC_i32ErrCode
000078  4618              MOV      r0,r3
;;;361    }
00007a  bd30              POP      {r4,r5,pc}
                  |L6.124|
00007c  f8d100d8          LDR      r0,[r1,#0xd8]         ;327
000080  e7d8              B        |L6.52|
                  |L6.130|
000082  f8d100dc          LDR      r0,[r1,#0xdc]         ;330
000086  e7d5              B        |L6.52|
;;;362    
                          ENDP

                  |L6.136|
                          DCD      0x4000c000
                  |L6.140|
                          DCD      0x0055aa03
                  |L6.144|
                          DCD      SystemCoreClock
                  |L6.148|
                          DCD      ||.data||

                          AREA ||i.FMC_Erase_Bank||, CODE, READONLY, ALIGN=2

                  FMC_Erase_Bank PROC
;;;258      */
;;;259    int32_t FMC_Erase_Bank(uint32_t u32BankAddr)
000000  4b13              LDR      r3,|L7.80|
;;;260    {
;;;261        int32_t  tout;
;;;262    
;;;263        g_FMC_i32ErrCode = 0;
000002  2100              MOVS     r1,#0
;;;264        FMC->ISPCMD = FMC_ISPCMD_BANK_ERASE;
000004  4a13              LDR      r2,|L7.84|
000006  6019              STR      r1,[r3,#0]  ; g_FMC_i32ErrCode
000008  2123              MOVS     r1,#0x23
00000a  60d1              STR      r1,[r2,#0xc]
;;;265        FMC->ISPADDR = u32BankAddr;
00000c  6050              STR      r0,[r2,#4]
;;;266        FMC->ISPTRG = FMC_ISPTRG_ISPGO_Msk;
00000e  2001              MOVS     r0,#1
000010  6110              STR      r0,[r2,#0x10]
;;;267    
;;;268        tout = FMC_TIMEOUT_ERASE;
000012  4811              LDR      r0,|L7.88|
000014  210a              MOVS     r1,#0xa
000016  6800              LDR      r0,[r0,#0]  ; SystemCoreClock
000018  fbb0f0f1          UDIV     r0,r0,r1
00001c  0081              LSLS     r1,r0,#2
                  |L7.30|
;;;269        while ((tout-- > 0) && (FMC->MPSTS & FMC_MPSTS_MPBUSY_Msk)) {}
00001e  1e08              SUBS     r0,r1,#0
000020  f1a10101          SUB      r1,r1,#1
000024  dd03              BLE      |L7.46|
000026  f8d200c0          LDR      r0,[r2,#0xc0]
00002a  07c0              LSLS     r0,r0,#31
00002c  d1f7              BNE      |L7.30|
                  |L7.46|
;;;270        if (tout <= 0)
;;;271        {
;;;272            g_FMC_i32ErrCode = -1;
00002e  f04f30ff          MOV      r0,#0xffffffff
000032  2900              CMP      r1,#0                 ;270
000034  dc01              BGT      |L7.58|
                  |L7.54|
;;;273            return -1;
000036  6018              STR      r0,[r3,#0]  ; g_FMC_i32ErrCode
;;;274        }
;;;275    
;;;276        if (FMC->ISPCTL & FMC_ISPCTL_ISPFF_Msk)
;;;277        {
;;;278            FMC->ISPCTL |= FMC_ISPCTL_ISPFF_Msk;
;;;279            g_FMC_i32ErrCode = -1;
;;;280            return -1;
;;;281        }
;;;282        return 0;
;;;283    }
000038  4770              BX       lr
                  |L7.58|
00003a  6811              LDR      r1,[r2,#0]            ;276
00003c  0649              LSLS     r1,r1,#25             ;276
00003e  d504              BPL      |L7.74|
000040  6811              LDR      r1,[r2,#0]            ;278
000042  f0410140          ORR      r1,r1,#0x40           ;278
000046  6011              STR      r1,[r2,#0]            ;278
000048  e7f5              B        |L7.54|
                  |L7.74|
00004a  2000              MOVS     r0,#0                 ;282
00004c  4770              BX       lr
;;;284    
                          ENDP

00004e  0000              DCW      0x0000
                  |L7.80|
                          DCD      ||.data||
                  |L7.84|
                          DCD      0x4000c000
                  |L7.88|
                          DCD      SystemCoreClock

                          AREA ||i.FMC_Erase_Block||, CODE, READONLY, ALIGN=2

                  FMC_Erase_Block PROC
;;;222      */
;;;223    int32_t FMC_Erase_Block(uint32_t u32BlockAddr)
000000  4b13              LDR      r3,|L8.80|
;;;224    {
;;;225        int32_t  tout;
;;;226    
;;;227        g_FMC_i32ErrCode = 0;
000002  2100              MOVS     r1,#0
;;;228        FMC->ISPCMD = FMC_ISPCMD_BLOCK_ERASE;
000004  4a13              LDR      r2,|L8.84|
000006  6019              STR      r1,[r3,#0]  ; g_FMC_i32ErrCode
000008  2125              MOVS     r1,#0x25
00000a  60d1              STR      r1,[r2,#0xc]
;;;229        FMC->ISPADDR = u32BlockAddr;
00000c  6050              STR      r0,[r2,#4]
;;;230        FMC->ISPTRG = FMC_ISPTRG_ISPGO_Msk;
00000e  2001              MOVS     r0,#1
000010  6110              STR      r0,[r2,#0x10]
;;;231    
;;;232        tout = FMC_TIMEOUT_ERASE;
000012  4811              LDR      r0,|L8.88|
000014  210a              MOVS     r1,#0xa
000016  6800              LDR      r0,[r0,#0]  ; SystemCoreClock
000018  fbb0f0f1          UDIV     r0,r0,r1
00001c  0081              LSLS     r1,r0,#2
                  |L8.30|
;;;233        while ((tout-- > 0) && (FMC->MPSTS & FMC_MPSTS_MPBUSY_Msk)) {}
00001e  1e08              SUBS     r0,r1,#0
000020  f1a10101          SUB      r1,r1,#1
000024  dd03              BLE      |L8.46|
000026  f8d200c0          LDR      r0,[r2,#0xc0]
00002a  07c0              LSLS     r0,r0,#31
00002c  d1f7              BNE      |L8.30|
                  |L8.46|
;;;234        if (tout <= 0)
;;;235        {
;;;236            g_FMC_i32ErrCode = -1;
00002e  f04f30ff          MOV      r0,#0xffffffff
000032  2900              CMP      r1,#0                 ;234
000034  dc01              BGT      |L8.58|
                  |L8.54|
;;;237            return -1;
000036  6018              STR      r0,[r3,#0]  ; g_FMC_i32ErrCode
;;;238        }
;;;239    
;;;240        if (FMC->ISPCTL & FMC_ISPCTL_ISPFF_Msk)
;;;241        {
;;;242            FMC->ISPCTL |= FMC_ISPCTL_ISPFF_Msk;
;;;243            g_FMC_i32ErrCode = -1;
;;;244            return -1;
;;;245        }
;;;246        return 0;
;;;247    }
000038  4770              BX       lr
                  |L8.58|
00003a  6811              LDR      r1,[r2,#0]            ;240
00003c  0649              LSLS     r1,r1,#25             ;240
00003e  d504              BPL      |L8.74|
000040  6811              LDR      r1,[r2,#0]            ;242
000042  f0410140          ORR      r1,r1,#0x40           ;242
000046  6011              STR      r1,[r2,#0]            ;242
000048  e7f5              B        |L8.54|
                  |L8.74|
00004a  2000              MOVS     r0,#0                 ;246
00004c  4770              BX       lr
;;;248    
                          ENDP

00004e  0000              DCW      0x0000
                  |L8.80|
                          DCD      ||.data||
                  |L8.84|
                          DCD      0x4000c000
                  |L8.88|
                          DCD      SystemCoreClock

                          AREA ||i.FMC_Erase_SPROM||, CODE, READONLY, ALIGN=2

                  FMC_Erase_SPROM PROC
;;;184      */
;;;185    int32_t FMC_Erase_SPROM(void)
000000  4b15              LDR      r3,|L9.88|
;;;186    {
;;;187        int32_t  tout;
;;;188    
;;;189        g_FMC_i32ErrCode = 0;
000002  2000              MOVS     r0,#0
;;;190        FMC->ISPCMD = FMC_ISPCMD_PAGE_ERASE;
000004  4915              LDR      r1,|L9.92|
000006  6018              STR      r0,[r3,#0]  ; g_FMC_i32ErrCode
000008  2022              MOVS     r0,#0x22
00000a  60c8              STR      r0,[r1,#0xc]
;;;191        FMC->ISPADDR = FMC_SPROM_BASE;
00000c  f44f1000          MOV      r0,#0x200000
000010  6048              STR      r0,[r1,#4]
;;;192        FMC->ISPDAT = 0x0055AA03UL;
000012  4813              LDR      r0,|L9.96|
000014  6088              STR      r0,[r1,#8]
;;;193        FMC->ISPTRG = FMC_ISPTRG_ISPGO_Msk;
000016  2001              MOVS     r0,#1
000018  6108              STR      r0,[r1,#0x10]
;;;194    
;;;195        tout = FMC_TIMEOUT_ERASE;
00001a  4812              LDR      r0,|L9.100|
00001c  220a              MOVS     r2,#0xa
00001e  6800              LDR      r0,[r0,#0]  ; SystemCoreClock
000020  fbb0f0f2          UDIV     r0,r0,r2
000024  0082              LSLS     r2,r0,#2
                  |L9.38|
;;;196        while ((tout-- > 0) && (FMC->MPSTS & FMC_MPSTS_MPBUSY_Msk)) {}
000026  1e10              SUBS     r0,r2,#0
000028  f1a20201          SUB      r2,r2,#1
00002c  dd03              BLE      |L9.54|
00002e  f8d100c0          LDR      r0,[r1,#0xc0]
000032  07c0              LSLS     r0,r0,#31
000034  d1f7              BNE      |L9.38|
                  |L9.54|
;;;197        if (tout <= 0)
;;;198        {
;;;199            g_FMC_i32ErrCode = -1;
000036  f04f30ff          MOV      r0,#0xffffffff
00003a  2a00              CMP      r2,#0                 ;197
00003c  dc01              BGT      |L9.66|
                  |L9.62|
;;;200            return -1;
00003e  6018              STR      r0,[r3,#0]  ; g_FMC_i32ErrCode
;;;201        }
;;;202    
;;;203        if (FMC->ISPCTL & FMC_ISPCTL_ISPFF_Msk)
;;;204        {
;;;205            FMC->ISPCTL |= FMC_ISPCTL_ISPFF_Msk;
;;;206            g_FMC_i32ErrCode = -1;
;;;207            return -1;
;;;208        }
;;;209        return 0;
;;;210    }
000040  4770              BX       lr
                  |L9.66|
000042  680a              LDR      r2,[r1,#0]            ;203
000044  0652              LSLS     r2,r2,#25             ;203
000046  d504              BPL      |L9.82|
000048  680a              LDR      r2,[r1,#0]            ;205
00004a  f0420240          ORR      r2,r2,#0x40           ;205
00004e  600a              STR      r2,[r1,#0]            ;205
000050  e7f5              B        |L9.62|
                  |L9.82|
000052  2000              MOVS     r0,#0                 ;209
000054  4770              BX       lr
;;;211    
                          ENDP

000056  0000              DCW      0x0000
                  |L9.88|
                          DCD      ||.data||
                  |L9.92|
                          DCD      0x4000c000
                  |L9.96|
                          DCD      0x0055aa03
                  |L9.100|
                          DCD      SystemCoreClock

                          AREA ||i.FMC_GetBootSource||, CODE, READONLY, ALIGN=2

                  FMC_GetBootSource PROC
;;;396      */
;;;397    int32_t FMC_GetBootSource (void)
000000  4806              LDR      r0,|L10.28|
;;;398    {
;;;399        if (FMC->ISPCTL & FMC_ISPCTL_BL_Msk)
000002  6801              LDR      r1,[r0,#0]
000004  03c9              LSLS     r1,r1,#15
000006  d501              BPL      |L10.12|
;;;400        {
;;;401            return 2;
000008  2002              MOVS     r0,#2
;;;402        }
;;;403        if (FMC->ISPCTL & FMC_ISPCTL_BS_Msk)
;;;404        {
;;;405            return 1;
;;;406        }
;;;407        return 0;
;;;408    }
00000a  4770              BX       lr
                  |L10.12|
00000c  6800              LDR      r0,[r0,#0]            ;403
00000e  0780              LSLS     r0,r0,#30             ;403
000010  d501              BPL      |L10.22|
000012  2001              MOVS     r0,#1                 ;405
000014  4770              BX       lr
                  |L10.22|
000016  2000              MOVS     r0,#0                 ;407
000018  4770              BX       lr
;;;409    
                          ENDP

00001a  0000              DCW      0x0000
                  |L10.28|
                          DCD      0x4000c000

                          AREA ||i.FMC_GetChkSum||, CODE, READONLY, ALIGN=2

                  FMC_GetChkSum PROC
;;;1038     */
;;;1039   uint32_t  FMC_GetChkSum(uint32_t u32addr, uint32_t u32count)
000000  b5f0              PUSH     {r4-r7,lr}
;;;1040   {
;;;1041       int32_t  tout;
;;;1042   
;;;1043       g_FMC_i32ErrCode = 0;
000002  4d1a              LDR      r5,|L11.108|
000004  4604              MOV      r4,r0                 ;1040
000006  2000              MOVS     r0,#0
;;;1044   
;;;1045       if ((u32addr % 4096UL) || (u32count % 4096UL))
000008  6028              STR      r0,[r5,#0]  ; g_FMC_i32ErrCode
00000a  ea440001          ORR      r0,r4,r1
00000e  0502              LSLS     r2,r0,#20
;;;1046       {
;;;1047           g_FMC_i32ErrCode = -2;
;;;1048           return 0xFFFFFFFF;
000010  f04f30ff          MOV      r0,#0xffffffff
000014  d002              BEQ      |L11.28|
000016  0041              LSLS     r1,r0,#1              ;1047
000018  6029              STR      r1,[r5,#0]  ; g_FMC_i32ErrCode
;;;1049       }
;;;1050   
;;;1051       FMC->ISPCMD  = FMC_ISPCMD_RUN_CKS;
;;;1052       FMC->ISPADDR = u32addr;
;;;1053       FMC->ISPDAT  = u32count;
;;;1054       FMC->ISPTRG  = FMC_ISPTRG_ISPGO_Msk;
;;;1055   
;;;1056       tout = FMC_TIMEOUT_CHKSUM;
;;;1057       while ((tout-- > 0) && (FMC->MPSTS & FMC_MPSTS_MPBUSY_Msk)) {}
;;;1058       if (tout <= 0)
;;;1059       {
;;;1060           g_FMC_i32ErrCode = -1;
;;;1061           return 0xFFFFFFFF;
;;;1062       }
;;;1063   
;;;1064       FMC->ISPCMD = FMC_ISPCMD_READ_CKS;
;;;1065       FMC->ISPADDR    = u32addr;
;;;1066       FMC->ISPTRG = FMC_ISPTRG_ISPGO_Msk;
;;;1067   
;;;1068       tout = FMC_TIMEOUT_CHKSUM;
;;;1069       while ((tout-- > 0) && (FMC->MPSTS & FMC_MPSTS_MPBUSY_Msk)) {}
;;;1070       if (tout <= 0)
;;;1071       {
;;;1072           g_FMC_i32ErrCode = -1;
;;;1073           return 0xFFFFFFFF;
;;;1074       }
;;;1075   
;;;1076       return FMC->ISPDAT;
;;;1077   }
00001a  bdf0              POP      {r4-r7,pc}
                  |L11.28|
00001c  4b14              LDR      r3,|L11.112|
00001e  222d              MOVS     r2,#0x2d              ;1051
000020  60da              STR      r2,[r3,#0xc]          ;1051
000022  605c              STR      r4,[r3,#4]            ;1052
000024  6099              STR      r1,[r3,#8]            ;1053
000026  2601              MOVS     r6,#1                 ;1054
000028  611e              STR      r6,[r3,#0x10]         ;1054
00002a  4912              LDR      r1,|L11.116|
00002c  6809              LDR      r1,[r1,#0]            ;1056  ; SystemCoreClock
00002e  0049              LSLS     r1,r1,#1              ;1056
000030  460a              MOV      r2,r1                 ;1056
                  |L11.50|
000032  1e17              SUBS     r7,r2,#0              ;1057
000034  f1a20201          SUB      r2,r2,#1              ;1057
000038  dd03              BLE      |L11.66|
00003a  f8d370c0          LDR      r7,[r3,#0xc0]         ;1057
00003e  07ff              LSLS     r7,r7,#31             ;1057
000040  d1f7              BNE      |L11.50|
                  |L11.66|
000042  2a00              CMP      r2,#0                 ;1058
000044  dd0d              BLE      |L11.98|
000046  220d              MOVS     r2,#0xd               ;1064
000048  60da              STR      r2,[r3,#0xc]          ;1064
00004a  605c              STR      r4,[r3,#4]            ;1065
00004c  611e              STR      r6,[r3,#0x10]         ;1066
                  |L11.78|
00004e  1e0a              SUBS     r2,r1,#0              ;1069
000050  f1a10101          SUB      r1,r1,#1              ;1069
000054  dd03              BLE      |L11.94|
000056  f8d320c0          LDR      r2,[r3,#0xc0]         ;1069
00005a  07d2              LSLS     r2,r2,#31             ;1069
00005c  d1f7              BNE      |L11.78|
                  |L11.94|
00005e  2900              CMP      r1,#0                 ;1070
000060  dc01              BGT      |L11.102|
                  |L11.98|
000062  6028              STR      r0,[r5,#0]            ;1073  ; g_FMC_i32ErrCode
000064  bdf0              POP      {r4-r7,pc}
                  |L11.102|
000066  6898              LDR      r0,[r3,#8]            ;1076
000068  bdf0              POP      {r4-r7,pc}
;;;1078   
                          ENDP

00006a  0000              DCW      0x0000
                  |L11.108|
                          DCD      ||.data||
                  |L11.112|
                          DCD      0x4000c000
                  |L11.116|
                          DCD      SystemCoreClock

                          AREA ||i.FMC_GetXOMState||, CODE, READONLY, ALIGN=2

                  FMC_GetXOMState PROC
;;;373      */
;;;374    int32_t FMC_GetXOMState(uint32_t u32XomNum)
000000  2804              CMP      r0,#4
;;;375    {
000002  d302              BCC      |L12.10|
;;;376        uint32_t u32act;
;;;377        int32_t  ret = 0;
;;;378    
;;;379        if (u32XomNum >= 4UL)
;;;380            ret = -2;
000004  f06f0001          MVN      r0,#1
;;;381    
;;;382        if (ret >= 0)
;;;383        {
;;;384            u32act = (((FMC->XOMSTS) & 0xful) & (1ul << u32XomNum)) >> u32XomNum;
;;;385            ret = (int32_t)u32act;
;;;386        }
;;;387        return ret;
;;;388    }
000008  4770              BX       lr
                  |L12.10|
00000a  4905              LDR      r1,|L12.32|
00000c  f8d110e0          LDR      r1,[r1,#0xe0]         ;384
000010  2201              MOVS     r2,#1                 ;384
000012  4082              LSLS     r2,r2,r0              ;384
000014  f002020f          AND      r2,r2,#0xf            ;384
000018  4011              ANDS     r1,r1,r2              ;384
00001a  fa21f000          LSR      r0,r1,r0              ;384
00001e  4770              BX       lr
;;;389    
                          ENDP

                  |L12.32|
                          DCD      0x4000c000

                          AREA ||i.FMC_Is_OTP_Locked||, CODE, READONLY, ALIGN=2

                  FMC_Is_OTP_Locked PROC
;;;890      */
;;;891    int32_t FMC_Is_OTP_Locked(uint32_t otp_num)
000000  4a19              LDR      r2,|L13.104|
;;;892    {
;;;893        int32_t  tout;
;;;894    
;;;895        g_FMC_i32ErrCode = 0;
000002  2300              MOVS     r3,#0
;;;896    
;;;897        if (otp_num > 255UL)
000004  28ff              CMP      r0,#0xff
000006  6013              STR      r3,[r2,#0]  ; g_FMC_i32ErrCode
000008  d901              BLS      |L13.14|
;;;898        {
;;;899            g_FMC_i32ErrCode = -2;
00000a  1e98              SUBS     r0,r3,#2
;;;900            return -2;
00000c  e019              B        |L13.66|
                  |L13.14|
;;;901        }
;;;902    
;;;903        FMC->ISPCMD = FMC_ISPCMD_READ;
00000e  4917              LDR      r1,|L13.108|
000010  60cb              STR      r3,[r1,#0xc]
;;;904        FMC->ISPADDR = FMC_OTP_BASE + 0x800UL + otp_num * 4UL;
000012  4b17              LDR      r3,|L13.112|
000014  eb030080          ADD      r0,r3,r0,LSL #2
000018  6048              STR      r0,[r1,#4]
;;;905        FMC->ISPTRG = FMC_ISPTRG_ISPGO_Msk;
00001a  2001              MOVS     r0,#1
00001c  6108              STR      r0,[r1,#0x10]
;;;906    
;;;907        tout = FMC_TIMEOUT_READ;
00001e  4815              LDR      r0,|L13.116|
000020  230a              MOVS     r3,#0xa
000022  6800              LDR      r0,[r0,#0]  ; SystemCoreClock
000024  fbb0f0f3          UDIV     r0,r0,r3
000028  0043              LSLS     r3,r0,#1
                  |L13.42|
;;;908        while ((tout-- > 0) && (FMC->MPSTS & FMC_MPSTS_MPBUSY_Msk)) {}
00002a  1e18              SUBS     r0,r3,#0
00002c  f1a30301          SUB      r3,r3,#1
000030  dd03              BLE      |L13.58|
000032  f8d100c0          LDR      r0,[r1,#0xc0]
000036  07c0              LSLS     r0,r0,#31
000038  d1f7              BNE      |L13.42|
                  |L13.58|
;;;909        if (tout <= 0)
;;;910        {
;;;911            g_FMC_i32ErrCode = -1;
00003a  f04f30ff          MOV      r0,#0xffffffff
00003e  2b00              CMP      r3,#0                 ;909
000040  dc01              BGT      |L13.70|
                  |L13.66|
;;;912            return -1;
000042  6010              STR      r0,[r2,#0]  ; g_FMC_i32ErrCode
;;;913        }
;;;914    
;;;915        if (FMC->ISPSTS & FMC_ISPSTS_ISPFF_Msk)
;;;916        {
;;;917            FMC->ISPSTS |= FMC_ISPSTS_ISPFF_Msk;
;;;918            g_FMC_i32ErrCode = -1;
;;;919            return -1;
;;;920        }
;;;921        else
;;;922        {
;;;923            if (FMC->ISPDAT != 0xFFFFFFFFUL)
;;;924            {
;;;925                g_FMC_i32ErrCode = -1;
;;;926                return 1;   /* Lock work was progrmmed. OTP was locked. */
;;;927            }
;;;928        }
;;;929        return 0;
;;;930    }
000044  4770              BX       lr
                  |L13.70|
000046  6c0b              LDR      r3,[r1,#0x40]         ;915
000048  065b              LSLS     r3,r3,#25             ;915
00004a  d504              BPL      |L13.86|
00004c  6c0b              LDR      r3,[r1,#0x40]         ;917
00004e  f0430340          ORR      r3,r3,#0x40           ;917
000052  640b              STR      r3,[r1,#0x40]         ;917
000054  e7f5              B        |L13.66|
                  |L13.86|
000056  6889              LDR      r1,[r1,#8]            ;923
000058  1c49              ADDS     r1,r1,#1              ;923
00005a  d002              BEQ      |L13.98|
00005c  6010              STR      r0,[r2,#0]            ;926  ; g_FMC_i32ErrCode
00005e  2001              MOVS     r0,#1                 ;926
000060  4770              BX       lr
                  |L13.98|
000062  2000              MOVS     r0,#0                 ;929
000064  4770              BX       lr
;;;931    
                          ENDP

000066  0000              DCW      0x0000
                  |L13.104|
                          DCD      ||.data||
                  |L13.108|
                          DCD      0x4000c000
                  |L13.112|
                          DCD      0x00310800
                  |L13.116|
                          DCD      SystemCoreClock

                          AREA ||i.FMC_Lock_OTP||, CODE, READONLY, ALIGN=2

                  FMC_Lock_OTP PROC
;;;844      */
;;;845    int32_t FMC_Lock_OTP(uint32_t otp_num)
000000  4b17              LDR      r3,|L14.96|
;;;846    {
000002  b510              PUSH     {r4,lr}
;;;847        int32_t  tout;
;;;848    
;;;849        g_FMC_i32ErrCode = 0;
000004  2200              MOVS     r2,#0
;;;850    
;;;851        if (otp_num > 255UL)
000006  601a              STR      r2,[r3,#0]  ; g_FMC_i32ErrCode
000008  28ff              CMP      r0,#0xff
00000a  d901              BLS      |L14.16|
;;;852        {
;;;853            g_FMC_i32ErrCode = -2;
00000c  1e90              SUBS     r0,r2,#2
;;;854            return -2;
00000e  e01b              B        |L14.72|
                  |L14.16|
;;;855        }
;;;856    
;;;857        FMC->ISPCMD = FMC_ISPCMD_PROGRAM;
000010  4914              LDR      r1,|L14.100|
000012  2421              MOVS     r4,#0x21
000014  60cc              STR      r4,[r1,#0xc]
;;;858        FMC->ISPADDR = FMC_OTP_BASE + 0x800UL + otp_num * 4UL;
000016  4c14              LDR      r4,|L14.104|
000018  eb040080          ADD      r0,r4,r0,LSL #2
00001c  6048              STR      r0,[r1,#4]
;;;859        FMC->ISPDAT = 0UL;
00001e  608a              STR      r2,[r1,#8]
;;;860        FMC->ISPTRG = FMC_ISPTRG_ISPGO_Msk;
000020  2001              MOVS     r0,#1
000022  6108              STR      r0,[r1,#0x10]
;;;861    
;;;862        tout = FMC_TIMEOUT_WRITE;
000024  4811              LDR      r0,|L14.108|
000026  220a              MOVS     r2,#0xa
000028  6800              LDR      r0,[r0,#0]  ; SystemCoreClock
00002a  fbb0f0f2          UDIV     r0,r0,r2
00002e  0042              LSLS     r2,r0,#1
                  |L14.48|
;;;863        while ((tout-- > 0) && (FMC->MPSTS & FMC_MPSTS_MPBUSY_Msk)) {}
000030  1e10              SUBS     r0,r2,#0
000032  f1a20201          SUB      r2,r2,#1
000036  dd03              BLE      |L14.64|
000038  f8d100c0          LDR      r0,[r1,#0xc0]
00003c  07c0              LSLS     r0,r0,#31
00003e  d1f7              BNE      |L14.48|
                  |L14.64|
;;;864        if (tout <= 0)
;;;865        {
;;;866            g_FMC_i32ErrCode = -1;
000040  f04f30ff          MOV      r0,#0xffffffff
000044  2a00              CMP      r2,#0                 ;864
000046  dc01              BGT      |L14.76|
                  |L14.72|
;;;867            return -1;
000048  6018              STR      r0,[r3,#0]  ; g_FMC_i32ErrCode
;;;868        }
;;;869    
;;;870        if (FMC->ISPSTS & FMC_ISPSTS_ISPFF_Msk)
;;;871        {
;;;872            FMC->ISPSTS |= FMC_ISPSTS_ISPFF_Msk;
;;;873            g_FMC_i32ErrCode = -1;
;;;874            return -1;
;;;875        }
;;;876        return 0;
;;;877    }
00004a  bd10              POP      {r4,pc}
                  |L14.76|
00004c  6c0a              LDR      r2,[r1,#0x40]         ;870
00004e  0652              LSLS     r2,r2,#25             ;870
000050  d504              BPL      |L14.92|
000052  6c0a              LDR      r2,[r1,#0x40]         ;872
000054  f0420240          ORR      r2,r2,#0x40           ;872
000058  640a              STR      r2,[r1,#0x40]         ;872
00005a  e7f5              B        |L14.72|
                  |L14.92|
00005c  2000              MOVS     r0,#0                 ;876
00005e  bd10              POP      {r4,pc}
;;;878    
                          ENDP

                  |L14.96|
                          DCD      ||.data||
                  |L14.100|
                          DCD      0x4000c000
                  |L14.104|
                          DCD      0x00310800
                  |L14.108|
                          DCD      SystemCoreClock

                          AREA ||i.FMC_Open||, CODE, READONLY, ALIGN=2

                  FMC_Open PROC
;;;414      */
;;;415    void FMC_Open(void)
000000  4802              LDR      r0,|L15.12|
;;;416    {
;;;417        FMC->ISPCTL |=  FMC_ISPCTL_ISPEN_Msk;
000002  6801              LDR      r1,[r0,#0]
000004  f0410101          ORR      r1,r1,#1
000008  6001              STR      r1,[r0,#0]
;;;418    }
00000a  4770              BX       lr
;;;419    
                          ENDP

                  |L15.12|
                          DCD      0x4000c000

                          AREA ||i.FMC_Read||, CODE, READONLY, ALIGN=2

                  FMC_Read PROC
;;;430      */
;;;431    uint32_t FMC_Read(uint32_t u32Addr)
000000  4a0e              LDR      r2,|L16.60|
;;;432    {
;;;433        int32_t  tout;
;;;434    
;;;435        g_FMC_i32ErrCode = 0;
;;;436        FMC->ISPCMD = FMC_ISPCMD_READ;
000002  490f              LDR      r1,|L16.64|
000004  2300              MOVS     r3,#0                 ;435
000006  6013              STR      r3,[r2,#0]  ; g_FMC_i32ErrCode
000008  60cb              STR      r3,[r1,#0xc]
;;;437        FMC->ISPADDR = u32Addr;
00000a  6048              STR      r0,[r1,#4]
;;;438        FMC->ISPTRG = FMC_ISPTRG_ISPGO_Msk;
00000c  2001              MOVS     r0,#1
00000e  6108              STR      r0,[r1,#0x10]
;;;439    
;;;440        tout = FMC_TIMEOUT_READ;
000010  480c              LDR      r0,|L16.68|
000012  230a              MOVS     r3,#0xa
000014  6800              LDR      r0,[r0,#0]  ; SystemCoreClock
000016  fbb0f0f3          UDIV     r0,r0,r3
00001a  0040              LSLS     r0,r0,#1
                  |L16.28|
;;;441        while ((tout-- > 0) && (FMC->MPSTS & FMC_MPSTS_MPBUSY_Msk)) {}
00001c  1e03              SUBS     r3,r0,#0
00001e  f1a00001          SUB      r0,r0,#1
000022  dd03              BLE      |L16.44|
000024  f8d130c0          LDR      r3,[r1,#0xc0]
000028  07db              LSLS     r3,r3,#31
00002a  d1f7              BNE      |L16.28|
                  |L16.44|
;;;442        if (tout <= 0)
00002c  2800              CMP      r0,#0
00002e  dc03              BGT      |L16.56|
;;;443        {
;;;444            g_FMC_i32ErrCode = -1;
000030  f04f30ff          MOV      r0,#0xffffffff
;;;445            return 0xFFFFFFFF;
000034  6010              STR      r0,[r2,#0]  ; g_FMC_i32ErrCode
;;;446        }
;;;447        return FMC->ISPDAT;
;;;448    }
000036  4770              BX       lr
                  |L16.56|
000038  6888              LDR      r0,[r1,#8]            ;447
00003a  4770              BX       lr
;;;449    
                          ENDP

                  |L16.60|
                          DCD      ||.data||
                  |L16.64|
                          DCD      0x4000c000
                  |L16.68|
                          DCD      SystemCoreClock

                          AREA ||i.FMC_ReadConfig||, CODE, READONLY, ALIGN=2

                  FMC_ReadConfig PROC
;;;945      */
;;;946    int32_t FMC_ReadConfig(uint32_t u32Config[], uint32_t u32Count)
000000  b570              PUSH     {r4-r6,lr}
;;;947    {
000002  4605              MOV      r5,r0
000004  460e              MOV      r6,r1
;;;948        int32_t   ret = 0;
000006  2400              MOVS     r4,#0
;;;949    
;;;950        u32Config[0] = FMC_Read(FMC_CONFIG_BASE);
000008  f44f1040          MOV      r0,#0x300000
00000c  f7fffffe          BL       FMC_Read
;;;951    
;;;952        if (g_FMC_i32ErrCode != 0)
000010  6028              STR      r0,[r5,#0]
000012  4807              LDR      r0,|L17.48|
000014  6800              LDR      r0,[r0,#0]  ; g_FMC_i32ErrCode
000016  2800              CMP      r0,#0
000018  d108              BNE      |L17.44|
;;;953            return g_FMC_i32ErrCode;
;;;954    
;;;955        if (u32Count < 2UL)
00001a  2e02              CMP      r6,#2
00001c  d201              BCS      |L17.34|
;;;956        {
;;;957            ret = -2;
00001e  1e84              SUBS     r4,r0,#2
000020  e003              B        |L17.42|
                  |L17.34|
;;;958        }
;;;959        else
;;;960        {
;;;961            u32Config[1] = FMC_Read(FMC_CONFIG_BASE+4UL);
000022  4804              LDR      r0,|L17.52|
000024  f7fffffe          BL       FMC_Read
000028  6068              STR      r0,[r5,#4]
                  |L17.42|
;;;962        }
;;;963        return ret;
00002a  4620              MOV      r0,r4
                  |L17.44|
;;;964    }
00002c  bd70              POP      {r4-r6,pc}
;;;965    
                          ENDP

00002e  0000              DCW      0x0000
                  |L17.48|
                          DCD      ||.data||
                  |L17.52|
                          DCD      0x00300004

                          AREA ||i.FMC_ReadDataFlashBaseAddr||, CODE, READONLY, ALIGN=2

                  FMC_ReadDataFlashBaseAddr PROC
;;;499      */
;;;500    uint32_t FMC_ReadDataFlashBaseAddr(void)
000000  4801              LDR      r0,|L18.8|
;;;501    {
;;;502        return FMC->DFBA;
000002  6940              LDR      r0,[r0,#0x14]
;;;503    }
000004  4770              BX       lr
;;;504    
                          ENDP

000006  0000              DCW      0x0000
                  |L18.8|
                          DCD      0x4000c000

                          AREA ||i.FMC_Read_64||, CODE, READONLY, ALIGN=2

                  FMC_Read_64 PROC
;;;462      */
;;;463    int32_t FMC_Read_64(uint32_t u32addr, uint32_t * u32data0, uint32_t * u32data1)
000000  b570              PUSH     {r4-r6,lr}
;;;464    {
;;;465        int32_t  tout;
;;;466    
;;;467        g_FMC_i32ErrCode = 0;
000002  4d16              LDR      r5,|L19.92|
000004  2400              MOVS     r4,#0
;;;468        FMC->ISPCMD = FMC_ISPCMD_READ_64;
000006  4b16              LDR      r3,|L19.96|
000008  2640              MOVS     r6,#0x40
00000a  602c              STR      r4,[r5,#0]  ; g_FMC_i32ErrCode
00000c  60de              STR      r6,[r3,#0xc]
;;;469        FMC->ISPADDR    = u32addr;
00000e  6058              STR      r0,[r3,#4]
;;;470        FMC->ISPDAT = 0x0UL;
000010  609c              STR      r4,[r3,#8]
;;;471        FMC->ISPTRG = FMC_ISPTRG_ISPGO_Msk;
000012  2001              MOVS     r0,#1
000014  6118              STR      r0,[r3,#0x10]
;;;472    
;;;473        tout = FMC_TIMEOUT_READ;
000016  4813              LDR      r0,|L19.100|
000018  240a              MOVS     r4,#0xa
00001a  6800              LDR      r0,[r0,#0]  ; SystemCoreClock
00001c  fbb0f0f4          UDIV     r0,r0,r4
000020  0044              LSLS     r4,r0,#1
                  |L19.34|
;;;474        while ((tout-- > 0) && (FMC->MPSTS & FMC_MPSTS_MPBUSY_Msk)) {}
000022  1e20              SUBS     r0,r4,#0
000024  f1a40401          SUB      r4,r4,#1
000028  dd03              BLE      |L19.50|
00002a  f8d300c0          LDR      r0,[r3,#0xc0]
00002e  07c0              LSLS     r0,r0,#31
000030  d1f7              BNE      |L19.34|
                  |L19.50|
;;;475        if (tout <= 0)
;;;476        {
;;;477            g_FMC_i32ErrCode = -1;
000032  f04f30ff          MOV      r0,#0xffffffff
000036  2c00              CMP      r4,#0                 ;475
000038  dc01              BGT      |L19.62|
                  |L19.58|
;;;478            return -1;
00003a  6028              STR      r0,[r5,#0]  ; g_FMC_i32ErrCode
;;;479        }
;;;480    
;;;481        if (FMC->ISPSTS & FMC_ISPSTS_ISPFF_Msk)
;;;482        {
;;;483            FMC->ISPSTS |= FMC_ISPSTS_ISPFF_Msk;
;;;484            g_FMC_i32ErrCode = -1;
;;;485            return -1;
;;;486        }
;;;487        else
;;;488        {
;;;489            *u32data0 = FMC->MPDAT0;
;;;490            *u32data1 = FMC->MPDAT1;
;;;491        }
;;;492        return 0;
;;;493    }
00003c  bd70              POP      {r4-r6,pc}
                  |L19.62|
00003e  6c1c              LDR      r4,[r3,#0x40]         ;481
000040  0664              LSLS     r4,r4,#25             ;481
000042  d504              BPL      |L19.78|
000044  6c19              LDR      r1,[r3,#0x40]         ;483
000046  f0410140          ORR      r1,r1,#0x40           ;483
00004a  6419              STR      r1,[r3,#0x40]         ;483
00004c  e7f5              B        |L19.58|
                  |L19.78|
00004e  f8530f80          LDR      r0,[r3,#0x80]!        ;489
000052  6008              STR      r0,[r1,#0]            ;490
000054  6858              LDR      r0,[r3,#4]            ;490
000056  6010              STR      r0,[r2,#0]            ;492
000058  2000              MOVS     r0,#0                 ;492
00005a  bd70              POP      {r4-r6,pc}
;;;494    
                          ENDP

                  |L19.92|
                          DCD      ||.data||
                  |L19.96|
                          DCD      0x4000c000
                  |L19.100|
                          DCD      SystemCoreClock

                          AREA ||i.FMC_Read_OTP||, CODE, READONLY, ALIGN=2

                  FMC_Read_OTP PROC
;;;794      */
;;;795    int32_t FMC_Read_OTP(uint32_t otp_num, uint32_t *low_word, uint32_t *high_word)
000000  b570              PUSH     {r4-r6,lr}
;;;796    {
;;;797        int32_t  tout;
;;;798    
;;;799        g_FMC_i32ErrCode = 0;
000002  4d1a              LDR      r5,|L20.108|
000004  2300              MOVS     r3,#0
;;;800    
;;;801        if (otp_num > 255UL)
000006  28ff              CMP      r0,#0xff
000008  602b              STR      r3,[r5,#0]  ; g_FMC_i32ErrCode
00000a  d901              BLS      |L20.16|
;;;802        {
;;;803            g_FMC_i32ErrCode = -2;
00000c  1e98              SUBS     r0,r3,#2
;;;804            return -2;
00000e  e01c              B        |L20.74|
                  |L20.16|
;;;805        }
;;;806    
;;;807        FMC->ISPCMD = FMC_ISPCMD_READ_64;
000010  4c17              LDR      r4,|L20.112|
000012  2640              MOVS     r6,#0x40
000014  60e6              STR      r6,[r4,#0xc]
;;;808        FMC->ISPADDR = FMC_OTP_BASE + otp_num * 8UL ;
000016  f44f1644          MOV      r6,#0x310000
00001a  eb0600c0          ADD      r0,r6,r0,LSL #3
00001e  6060              STR      r0,[r4,#4]
;;;809        FMC->ISPDAT = 0x0UL;
000020  60a3              STR      r3,[r4,#8]
;;;810        FMC->ISPTRG = FMC_ISPTRG_ISPGO_Msk;
000022  2001              MOVS     r0,#1
000024  6120              STR      r0,[r4,#0x10]
;;;811    
;;;812        tout = FMC_TIMEOUT_WRITE;
000026  4813              LDR      r0,|L20.116|
000028  230a              MOVS     r3,#0xa
00002a  6800              LDR      r0,[r0,#0]  ; SystemCoreClock
00002c  fbb0f0f3          UDIV     r0,r0,r3
000030  0043              LSLS     r3,r0,#1
                  |L20.50|
;;;813        while ((tout-- > 0) && (FMC->MPSTS & FMC_MPSTS_MPBUSY_Msk)) {}
000032  1e18              SUBS     r0,r3,#0
000034  f1a30301          SUB      r3,r3,#1
000038  dd03              BLE      |L20.66|
00003a  f8d400c0          LDR      r0,[r4,#0xc0]
00003e  07c0              LSLS     r0,r0,#31
000040  d1f7              BNE      |L20.50|
                  |L20.66|
;;;814        if (tout <= 0)
;;;815        {
;;;816            g_FMC_i32ErrCode = -1;
000042  f04f30ff          MOV      r0,#0xffffffff
000046  2b00              CMP      r3,#0                 ;814
000048  dc01              BGT      |L20.78|
                  |L20.74|
;;;817            return -1;
00004a  6028              STR      r0,[r5,#0]  ; g_FMC_i32ErrCode
;;;818        }
;;;819    
;;;820        if (FMC->ISPSTS & FMC_ISPSTS_ISPFF_Msk)
;;;821        {
;;;822            FMC->ISPSTS |= FMC_ISPSTS_ISPFF_Msk;
;;;823            g_FMC_i32ErrCode = -1;
;;;824            return -1;
;;;825        }
;;;826        else
;;;827        {
;;;828            *low_word = FMC->MPDAT0;
;;;829            *high_word = FMC->MPDAT1;
;;;830        }
;;;831        return 0;
;;;832    }
00004c  bd70              POP      {r4-r6,pc}
                  |L20.78|
00004e  6c23              LDR      r3,[r4,#0x40]         ;820
000050  065b              LSLS     r3,r3,#25             ;820
000052  d504              BPL      |L20.94|
000054  6c21              LDR      r1,[r4,#0x40]         ;822
000056  f0410140          ORR      r1,r1,#0x40           ;822
00005a  6421              STR      r1,[r4,#0x40]         ;822
00005c  e7f5              B        |L20.74|
                  |L20.94|
00005e  f8540f80          LDR      r0,[r4,#0x80]!        ;828
000062  6008              STR      r0,[r1,#0]            ;829
000064  6860              LDR      r0,[r4,#4]            ;829
000066  6010              STR      r0,[r2,#0]            ;831
000068  2000              MOVS     r0,#0                 ;831
00006a  bd70              POP      {r4-r6,pc}
;;;833    
                          ENDP

                  |L20.108|
                          DCD      ||.data||
                  |L20.112|
                          DCD      0x4000c000
                  |L20.116|
                          DCD      SystemCoreClock

                          AREA ||i.FMC_SetBootSource||, CODE, READONLY, ALIGN=2

                  FMC_SetBootSource PROC
;;;514      */
;;;515    void FMC_SetBootSource(int32_t i32BootSrc)
000000  4905              LDR      r1,|L21.24|
;;;516    {
;;;517        if(i32BootSrc)
000002  2800              CMP      r0,#0
;;;518        {
;;;519            FMC->ISPCTL |= FMC_ISPCTL_BS_Msk; /* Boot from LDROM */
;;;520        }
;;;521        else
;;;522        {
;;;523            FMC->ISPCTL &= ~FMC_ISPCTL_BS_Msk;/* Boot from APROM */
000004  6808              LDR      r0,[r1,#0]
000006  d002              BEQ      |L21.14|
000008  f0400002          ORR      r0,r0,#2              ;519
00000c  e001              B        |L21.18|
                  |L21.14|
00000e  f0200002          BIC      r0,r0,#2
                  |L21.18|
000012  6008              STR      r0,[r1,#0]            ;519
;;;524        }
;;;525    }
000014  4770              BX       lr
;;;526    
                          ENDP

000016  0000              DCW      0x0000
                  |L21.24|
                          DCD      0x4000c000

                          AREA ||i.FMC_SetSPKey||, CODE, READONLY, ALIGN=2

                  FMC_SetSPKey PROC
;;;1156     */
;;;1157   int32_t  FMC_SetSPKey(uint32_t key[3], uint32_t kpmax, uint32_t kemax,
000000  e92d4fff          PUSH     {r0-r11,lr}
;;;1158                         const int32_t lock_CONFIG, const int32_t lock_SPROM)
;;;1159   {
;;;1160       uint32_t  lock_ctrl = 0UL;
;;;1161       uint32_t  u32KeySts;
;;;1162       int32_t   tout;
;;;1163       int32_t   ret = 0;
;;;1164   
;;;1165       g_FMC_i32ErrCode = 0;
000004  4d47              LDR      r5,|L22.292|
;;;1166   
;;;1167       if (FMC->KPKEYSTS != 0x200UL)
000006  f8dfa120          LDR      r10,|L22.296|
00000a  2700              MOVS     r7,#0                 ;1160
00000c  f8dd9034          LDR      r9,[sp,#0x34]         ;1165
000010  4606              MOV      r6,r0                 ;1159
000012  602f              STR      r7,[r5,#0]  ; g_FMC_i32ErrCode
000014  f8da0060          LDR      r0,[r10,#0x60]
000018  4698              MOV      r8,r3                 ;1159
00001a  463c              MOV      r4,r7                 ;1163
00001c  f5b07f00          CMP      r0,#0x200
000020  d000              BEQ      |L22.36|
;;;1168       {
;;;1169           ret = -1;
000022  1e7c              SUBS     r4,r7,#1
                  |L22.36|
;;;1170       }
;;;1171   
;;;1172       if (FMC_Erase(FMC_KPROM_BASE))
000024  4841              LDR      r0,|L22.300|
000026  f7fffffe          BL       FMC_Erase
00002a  b108              CBZ      r0,|L22.48|
;;;1173       {
;;;1174           ret = -2;
00002c  f06f0401          MVN      r4,#1
                  |L22.48|
;;;1175       }
;;;1176   
;;;1177       if (FMC_Erase(FMC_KPROM_BASE+0x200UL))
000030  483f              LDR      r0,|L22.304|
000032  f7fffffe          BL       FMC_Erase
;;;1178       {
;;;1179           ret = -3;
000036  f06f0b02          MVN      r11,#2
00003a  b100              CBZ      r0,|L22.62|
00003c  465c              MOV      r4,r11
                  |L22.62|
;;;1180       }
;;;1181   
;;;1182       if (!lock_CONFIG)
00003e  f1b80f00          CMP      r8,#0
000042  d100              BNE      |L22.70|
;;;1183       {
;;;1184           lock_ctrl |= 0x1UL;
000044  2701              MOVS     r7,#1
                  |L22.70|
;;;1185       }
;;;1186   
;;;1187       if (!lock_SPROM)
000046  f1b90f00          CMP      r9,#0
00004a  d101              BNE      |L22.80|
;;;1188       {
;;;1189           lock_ctrl |= 0x2UL;
00004c  f0470702          ORR      r7,r7,#2
                  |L22.80|
;;;1190       }
;;;1191   
;;;1192       if (ret == 0)
000050  bb94              CBNZ     r4,|L22.184|
;;;1193       {
;;;1194           FMC_Write(FMC_KPROM_BASE, key[0]);
000052  4836              LDR      r0,|L22.300|
000054  6831              LDR      r1,[r6,#0]
000056  f7fffffe          BL       FMC_Write
;;;1195           FMC_Write(FMC_KPROM_BASE+0x4UL, key[1]);
00005a  4834              LDR      r0,|L22.300|
00005c  6871              LDR      r1,[r6,#4]
00005e  1d00              ADDS     r0,r0,#4
000060  f7fffffe          BL       FMC_Write
;;;1196           FMC_Write(FMC_KPROM_BASE+0x8UL, key[2]);
000064  4831              LDR      r0,|L22.300|
000066  68b1              LDR      r1,[r6,#8]
000068  3008              ADDS     r0,r0,#8
00006a  f7fffffe          BL       FMC_Write
;;;1197           FMC_Write(FMC_KPROM_BASE+0xCUL, kpmax);
00006e  482f              LDR      r0,|L22.300|
000070  9901              LDR      r1,[sp,#4]
000072  300c              ADDS     r0,r0,#0xc
000074  f7fffffe          BL       FMC_Write
;;;1198           FMC_Write(FMC_KPROM_BASE+0x10UL, kemax);
000078  482c              LDR      r0,|L22.300|
00007a  9902              LDR      r1,[sp,#8]
00007c  3010              ADDS     r0,r0,#0x10
00007e  f7fffffe          BL       FMC_Write
;;;1199           FMC_Write(FMC_KPROM_BASE+0x14UL, lock_ctrl);
000082  482a              LDR      r0,|L22.300|
000084  4639              MOV      r1,r7
000086  3014              ADDS     r0,r0,#0x14
000088  f7fffffe          BL       FMC_Write
;;;1200   
;;;1201           tout = FMC_TIMEOUT_WRITE;
00008c  4829              LDR      r0,|L22.308|
00008e  210a              MOVS     r1,#0xa
000090  6800              LDR      r0,[r0,#0]  ; SystemCoreClock
000092  fbb0f0f1          UDIV     r0,r0,r1
000096  0040              LSLS     r0,r0,#1
000098  4651              MOV      r1,r10                ;1167
                  |L22.154|
;;;1202           while ((tout-- > 0) && (FMC->KPKEYSTS & FMC_KPKEYSTS_KEYBUSY_Msk)) {}
00009a  1e02              SUBS     r2,r0,#0
00009c  f1a00001          SUB      r0,r0,#1
0000a0  dd02              BLE      |L22.168|
0000a2  6e0a              LDR      r2,[r1,#0x60]
0000a4  07d2              LSLS     r2,r2,#31
0000a6  d1f8              BNE      |L22.154|
                  |L22.168|
;;;1203           if (tout <= 0)
0000a8  2800              CMP      r0,#0
0000aa  dc06              BGT      |L22.186|
;;;1204           {
;;;1205               g_FMC_i32ErrCode = -3;
0000ac  4658              MOV      r0,r11
;;;1206               return -3;
0000ae  f8c5b000          STR      r11,[r5,#0]  ; g_FMC_i32ErrCode
                  |L22.178|
;;;1207           }
;;;1208   
;;;1209           u32KeySts = FMC->KPKEYSTS;
;;;1210   
;;;1211           if (!(u32KeySts & FMC_KPKEYSTS_KEYLOCK_Msk))
;;;1212           {
;;;1213               /* Security key lock failed! */
;;;1214               ret = -4;
;;;1215           }
;;;1216           else if ((lock_CONFIG && (!(u32KeySts & FMC_KPKEYSTS_CFGFLAG_Msk))) ||
;;;1217                    ((!lock_CONFIG) && (u32KeySts & FMC_KPKEYSTS_CFGFLAG_Msk)))
;;;1218           {
;;;1219               /* CONFIG lock failed! */
;;;1220               ret = -5;
;;;1221           }
;;;1222           else if ((lock_SPROM && (!(u32KeySts & FMC_KPKEYSTS_SPFLAG_Msk))) ||
;;;1223                    ((!lock_SPROM) && (u32KeySts & FMC_KPKEYSTS_SPFLAG_Msk)))
;;;1224           {
;;;1225               /* CONFIG lock failed! */
;;;1226               ret = -6;
;;;1227           }
;;;1228           else if (((FMC->KPCNT & FMC_KPCNT_KPMAX_Msk) >> FMC_KPCNT_KPMAX_Pos) != kpmax)
;;;1229           {
;;;1230               /* KPMAX failed! */
;;;1231               ret = -7;
;;;1232           }
;;;1233           else if (((FMC->KPKEYCNT & FMC_KPKEYCNT_KPKEMAX_Msk) >> FMC_KPKEYCNT_KPKEMAX_Pos) != kemax)
;;;1234           {
;;;1235               /* KEMAX failed! */
;;;1236               ret = -8;
;;;1237           }
;;;1238       }
;;;1239       g_FMC_i32ErrCode = ret;
;;;1240       return ret;
;;;1241   }
0000b2  b004              ADD      sp,sp,#0x10
0000b4  e8bd8ff0          POP      {r4-r11,pc}
                  |L22.184|
0000b8  e030              B        |L22.284|
                  |L22.186|
0000ba  6e08              LDR      r0,[r1,#0x60]         ;1209
0000bc  0782              LSLS     r2,r0,#30             ;1211
0000be  d402              BMI      |L22.198|
0000c0  f06f0403          MVN      r4,#3                 ;1214
0000c4  e02a              B        |L22.284|
                  |L22.198|
0000c6  f1b80f00          CMP      r8,#0                 ;1216
0000ca  ea4f6280          LSL      r2,r0,#26             ;1217
0000ce  d002              BEQ      |L22.214|
0000d0  2a00              CMP      r2,#0                 ;1216
0000d2  da02              BGE      |L22.218|
0000d4  e004              B        |L22.224|
                  |L22.214|
0000d6  2a00              CMP      r2,#0                 ;1217
0000d8  da02              BGE      |L22.224|
                  |L22.218|
0000da  f06f0404          MVN      r4,#4                 ;1220
0000de  e01d              B        |L22.284|
                  |L22.224|
0000e0  f1b90f00          CMP      r9,#0                 ;1222
0000e4  ea4f6040          LSL      r0,r0,#25             ;1223
0000e8  d002              BEQ      |L22.240|
0000ea  2800              CMP      r0,#0                 ;1222
0000ec  da02              BGE      |L22.244|
0000ee  e004              B        |L22.250|
                  |L22.240|
0000f0  2800              CMP      r0,#0                 ;1223
0000f2  da02              BGE      |L22.250|
                  |L22.244|
0000f4  f06f0405          MVN      r4,#5                 ;1226
0000f8  e010              B        |L22.284|
                  |L22.250|
0000fa  6e88              LDR      r0,[r1,#0x68]         ;1228
0000fc  f3c02203          UBFX     r2,r0,#8,#4           ;1228
000100  9801              LDR      r0,[sp,#4]            ;1228
000102  4282              CMP      r2,r0                 ;1228
000104  d002              BEQ      |L22.268|
000106  f06f0406          MVN      r4,#6                 ;1231
00010a  e007              B        |L22.284|
                  |L22.268|
00010c  6e48              LDR      r0,[r1,#0x64]         ;1233
00010e  f3c02105          UBFX     r1,r0,#8,#6           ;1233
000112  9802              LDR      r0,[sp,#8]            ;1233
000114  4281              CMP      r1,r0                 ;1233
000116  d001              BEQ      |L22.284|
000118  f06f0407          MVN      r4,#7                 ;1236
                  |L22.284|
00011c  4620              MOV      r0,r4                 ;1240
00011e  602c              STR      r4,[r5,#0]            ;1240  ; g_FMC_i32ErrCode
000120  e7c7              B        |L22.178|
;;;1242   
                          ENDP

000122  0000              DCW      0x0000
                  |L22.292|
                          DCD      ||.data||
                  |L22.296|
                          DCD      0x4000c000
                  |L22.300|
                          DCD      0x00301000
                  |L22.304|
                          DCD      0x00301200
                  |L22.308|
                          DCD      SystemCoreClock

                          AREA ||i.FMC_Write||, CODE, READONLY, ALIGN=2

                  FMC_Write PROC
;;;537      */
;;;538    int32_t FMC_Write(uint32_t u32Addr, uint32_t u32Data)
000000  4b14              LDR      r3,|L23.84|
;;;539    {
000002  b510              PUSH     {r4,lr}
;;;540        int32_t  tout;
;;;541    
;;;542        g_FMC_i32ErrCode = 0;
000004  2200              MOVS     r2,#0
;;;543        FMC->ISPCMD = FMC_ISPCMD_PROGRAM;
000006  601a              STR      r2,[r3,#0]  ; g_FMC_i32ErrCode
000008  4a13              LDR      r2,|L23.88|
00000a  2421              MOVS     r4,#0x21
00000c  60d4              STR      r4,[r2,#0xc]
;;;544        FMC->ISPADDR = u32Addr;
00000e  6050              STR      r0,[r2,#4]
;;;545        FMC->ISPDAT = u32Data;
000010  6091              STR      r1,[r2,#8]
;;;546        FMC->ISPTRG = FMC_ISPTRG_ISPGO_Msk;
000012  2001              MOVS     r0,#1
000014  6110              STR      r0,[r2,#0x10]
;;;547    
;;;548        tout = FMC_TIMEOUT_WRITE;
000016  4811              LDR      r0,|L23.92|
000018  210a              MOVS     r1,#0xa
00001a  6800              LDR      r0,[r0,#0]  ; SystemCoreClock
00001c  fbb0f0f1          UDIV     r0,r0,r1
000020  0041              LSLS     r1,r0,#1
                  |L23.34|
;;;549        while ((tout-- > 0) && (FMC->MPSTS & FMC_MPSTS_MPBUSY_Msk)) {}
000022  1e08              SUBS     r0,r1,#0
000024  f1a10101          SUB      r1,r1,#1
000028  dd03              BLE      |L23.50|
00002a  f8d200c0          LDR      r0,[r2,#0xc0]
00002e  07c0              LSLS     r0,r0,#31
000030  d1f7              BNE      |L23.34|
                  |L23.50|
;;;550        if (tout <= 0)
;;;551        {
;;;552            g_FMC_i32ErrCode = -1;
000032  f04f30ff          MOV      r0,#0xffffffff
000036  2900              CMP      r1,#0                 ;550
000038  dc01              BGT      |L23.62|
                  |L23.58|
;;;553            return -1;
00003a  6018              STR      r0,[r3,#0]  ; g_FMC_i32ErrCode
;;;554        }
;;;555    
;;;556        if (FMC->ISPSTS & FMC_ISPSTS_ISPFF_Msk)
;;;557        {
;;;558            FMC->ISPSTS |= FMC_ISPSTS_ISPFF_Msk;
;;;559            g_FMC_i32ErrCode = -1;
;;;560            return -1;
;;;561        }
;;;562        return 0;
;;;563    }
00003c  bd10              POP      {r4,pc}
                  |L23.62|
00003e  6c11              LDR      r1,[r2,#0x40]         ;556
000040  0649              LSLS     r1,r1,#25             ;556
000042  d504              BPL      |L23.78|
000044  6c11              LDR      r1,[r2,#0x40]         ;558
000046  f0410140          ORR      r1,r1,#0x40           ;558
00004a  6411              STR      r1,[r2,#0x40]         ;558
00004c  e7f5              B        |L23.58|
                  |L23.78|
00004e  2000              MOVS     r0,#0                 ;562
000050  bd10              POP      {r4,pc}
;;;564    
                          ENDP

000052  0000              DCW      0x0000
                  |L23.84|
                          DCD      ||.data||
                  |L23.88|
                          DCD      0x4000c000
                  |L23.92|
                          DCD      SystemCoreClock

                          AREA ||i.FMC_Write8Bytes||, CODE, READONLY, ALIGN=2

                  FMC_Write8Bytes PROC
;;;576      */
;;;577    int32_t FMC_Write8Bytes(uint32_t u32addr, uint32_t u32data0, uint32_t u32data1)
000000  b530              PUSH     {r4,r5,lr}
;;;578    {
;;;579        int32_t  tout;
;;;580    
;;;581        g_FMC_i32ErrCode = 0;
000002  4c15              LDR      r4,|L24.88|
000004  2300              MOVS     r3,#0
;;;582        FMC->ISPCMD  = FMC_ISPCMD_PROGRAM_64;
000006  2561              MOVS     r5,#0x61
000008  6023              STR      r3,[r4,#0]  ; g_FMC_i32ErrCode
00000a  4b14              LDR      r3,|L24.92|
00000c  60dd              STR      r5,[r3,#0xc]
;;;583        FMC->ISPADDR = u32addr;
00000e  6058              STR      r0,[r3,#4]
;;;584        FMC->MPDAT0  = u32data0;
000010  f8c31080          STR      r1,[r3,#0x80]
;;;585        FMC->MPDAT1  = u32data1;
000014  f8c32084          STR      r2,[r3,#0x84]
;;;586        FMC->ISPTRG  = FMC_ISPTRG_ISPGO_Msk;
000018  2001              MOVS     r0,#1
00001a  6118              STR      r0,[r3,#0x10]
;;;587    
;;;588        tout = FMC_TIMEOUT_WRITE;
00001c  4810              LDR      r0,|L24.96|
00001e  210a              MOVS     r1,#0xa
000020  6800              LDR      r0,[r0,#0]  ; SystemCoreClock
000022  fbb0f0f1          UDIV     r0,r0,r1
000026  0041              LSLS     r1,r0,#1
                  |L24.40|
;;;589        while ((tout-- > 0) && (FMC->MPSTS & FMC_MPSTS_MPBUSY_Msk)) {}
000028  1e08              SUBS     r0,r1,#0
00002a  f1a10101          SUB      r1,r1,#1
00002e  dd03              BLE      |L24.56|
000030  f8d300c0          LDR      r0,[r3,#0xc0]
000034  07c0              LSLS     r0,r0,#31
000036  d1f7              BNE      |L24.40|
                  |L24.56|
;;;590        if (tout <= 0)
;;;591        {
;;;592            g_FMC_i32ErrCode = -1;
000038  f04f30ff          MOV      r0,#0xffffffff
00003c  2900              CMP      r1,#0                 ;590
00003e  dc01              BGT      |L24.68|
                  |L24.64|
;;;593            return -1;
000040  6020              STR      r0,[r4,#0]  ; g_FMC_i32ErrCode
;;;594        }
;;;595    
;;;596        if (FMC->ISPSTS & FMC_ISPSTS_ISPFF_Msk)
;;;597        {
;;;598            FMC->ISPSTS |= FMC_ISPSTS_ISPFF_Msk;
;;;599            g_FMC_i32ErrCode = -1;
;;;600            return -1;
;;;601        }
;;;602        return 0;
;;;603    }
000042  bd30              POP      {r4,r5,pc}
                  |L24.68|
000044  6c19              LDR      r1,[r3,#0x40]         ;596
000046  0649              LSLS     r1,r1,#25             ;596
000048  d504              BPL      |L24.84|
00004a  6c19              LDR      r1,[r3,#0x40]         ;598
00004c  f0410140          ORR      r1,r1,#0x40           ;598
000050  6419              STR      r1,[r3,#0x40]         ;598
000052  e7f5              B        |L24.64|
                  |L24.84|
000054  2000              MOVS     r0,#0                 ;602
000056  bd30              POP      {r4,r5,pc}
;;;604    
                          ENDP

                  |L24.88|
                          DCD      ||.data||
                  |L24.92|
                          DCD      0x4000c000
                  |L24.96|
                          DCD      SystemCoreClock

                          AREA ||i.FMC_WriteConfig||, CODE, READONLY, ALIGN=2

                  FMC_WriteConfig PROC
;;;978      */
;;;979    int32_t FMC_WriteConfig(uint32_t u32Config[], uint32_t u32Count)
000000  e92d4ff0          PUSH     {r4-r11,lr}
;;;980    {
;;;981        int   i;
;;;982    
;;;983        FMC_ENABLE_CFG_UPDATE();
000004  4c24              LDR      r4,|L25.152|
000006  4680              MOV      r8,r0                 ;980
000008  460f              MOV      r7,r1                 ;980
00000a  6820              LDR      r0,[r4,#0]
00000c  f0400010          ORR      r0,r0,#0x10
000010  6020              STR      r0,[r4,#0]
;;;984    
;;;985        if (FMC_Erase(FMC_CONFIG_BASE) != 0)
000012  01a6              LSLS     r6,r4,#6
000014  4630              MOV      r0,r6
000016  f7fffffe          BL       FMC_Erase
;;;986            return -1;
00001a  f04f3aff          MOV      r10,#0xffffffff
00001e  b110              CBZ      r0,|L25.38|
                  |L25.32|
000020  4650              MOV      r0,r10
                  |L25.34|
;;;987    
;;;988        if ((FMC_Read(FMC_CONFIG_BASE) != 0xFFFFFFFF) || (FMC_Read(FMC_CONFIG_BASE+4) != 0xFFFFFFFF) ||
;;;989                (FMC_Read(FMC_CONFIG_BASE+8) != 0xFFFF5A5A))
;;;990        {
;;;991            FMC_DISABLE_CFG_UPDATE();
;;;992            return -1;
;;;993        }
;;;994    
;;;995        if (g_FMC_i32ErrCode != 0)
;;;996        {
;;;997            FMC_DISABLE_CFG_UPDATE();
;;;998            return -1;
;;;999        }
;;;1000   
;;;1001       for (i = 0; i < u32Count; i++)
;;;1002       {
;;;1003           if (FMC_Write(FMC_CONFIG_BASE+i*4UL, u32Config[i]) != 0)
;;;1004           {
;;;1005               FMC_DISABLE_CFG_UPDATE();
;;;1006               return -1;
;;;1007           }
;;;1008   
;;;1009           if (FMC_Read(FMC_CONFIG_BASE+i*4UL) != u32Config[i])
;;;1010           {
;;;1011               FMC_DISABLE_CFG_UPDATE();
;;;1012               return -1;
;;;1013           }
;;;1014   
;;;1015           if (g_FMC_i32ErrCode != 0)
;;;1016           {
;;;1017               FMC_DISABLE_CFG_UPDATE();
;;;1018               return -1;
;;;1019           }
;;;1020       }
;;;1021   
;;;1022       FMC_DISABLE_CFG_UPDATE();
;;;1023       return 0;
;;;1024   }
000022  e8bd8ff0          POP      {r4-r11,pc}
                  |L25.38|
000026  4630              MOV      r0,r6                 ;988
000028  f7fffffe          BL       FMC_Read
00002c  1c40              ADDS     r0,r0,#1              ;988
00002e  d125              BNE      |L25.124|
000030  481a              LDR      r0,|L25.156|
000032  f7fffffe          BL       FMC_Read
000036  1c40              ADDS     r0,r0,#1              ;988
000038  d120              BNE      |L25.124|
00003a  4818              LDR      r0,|L25.156|
00003c  1d00              ADDS     r0,r0,#4              ;989
00003e  f7fffffe          BL       FMC_Read
000042  f24a51a6          MOV      r1,#0xa5a6            ;989
000046  42c8              CMN      r0,r1                 ;989
000048  d118              BNE      |L25.124|
00004a  4815              LDR      r0,|L25.160|
00004c  6801              LDR      r1,[r0,#0]            ;995  ; g_FMC_i32ErrCode
00004e  b9a9              CBNZ     r1,|L25.124|
000050  2500              MOVS     r5,#0                 ;1001
000052  46b1              MOV      r9,r6                 ;985
000054  4683              MOV      r11,r0                ;995
000056  e017              B        |L25.136|
                  |L25.88|
000058  eb090085          ADD      r0,r9,r5,LSL #2       ;1003
00005c  f8581025          LDR      r1,[r8,r5,LSL #2]     ;1003
000060  4606              MOV      r6,r0                 ;1003
000062  f7fffffe          BL       FMC_Write
000066  b948              CBNZ     r0,|L25.124|
000068  4630              MOV      r0,r6                 ;1003
00006a  f7fffffe          BL       FMC_Read
00006e  f8581025          LDR      r1,[r8,r5,LSL #2]     ;1009
000072  4288              CMP      r0,r1                 ;1009
000074  d102              BNE      |L25.124|
000076  f8db0000          LDR      r0,[r11,#0]           ;1015  ; g_FMC_i32ErrCode
00007a  b120              CBZ      r0,|L25.134|
                  |L25.124|
00007c  6820              LDR      r0,[r4,#0]            ;1017
00007e  f0200010          BIC      r0,r0,#0x10           ;1017
000082  6020              STR      r0,[r4,#0]            ;1017
000084  e7cc              B        |L25.32|
                  |L25.134|
000086  1c6d              ADDS     r5,r5,#1              ;1018
                  |L25.136|
000088  42bd              CMP      r5,r7                 ;1001
00008a  d3e5              BCC      |L25.88|
00008c  6820              LDR      r0,[r4,#0]            ;1022
00008e  f0200010          BIC      r0,r0,#0x10           ;1022
000092  6020              STR      r0,[r4,#0]            ;1022
000094  2000              MOVS     r0,#0                 ;1023
000096  e7c4              B        |L25.34|
;;;1025   
                          ENDP

                  |L25.152|
                          DCD      0x4000c000
                  |L25.156|
                          DCD      0x00300004
                  |L25.160|
                          DCD      ||.data||

                          AREA ||i.FMC_WriteMultiple||, CODE, READONLY, ALIGN=2

                  FMC_WriteMultiple PROC
;;;619      */
;;;620    int32_t FMC_WriteMultiple(uint32_t u32Addr, uint32_t pu32Buf[], uint32_t u32Len)
000000  e92d4ff0          PUSH     {r4-r11,lr}
;;;621    {
000004  4606              MOV      r6,r0
;;;622        int   i, idx, retval = 0;
;;;623        int32_t  tout;
;;;624    
;;;625        g_FMC_i32ErrCode = 0;
000006  f8df9140          LDR      r9,|L26.328|
00000a  2000              MOVS     r0,#0                 ;622
;;;626    
;;;627        if ((u32Addr >= FMC_APROM_END) || ((u32Addr % 8) != 0))
00000c  f5b62f00          CMP      r6,#0x80000
000010  f8c90000          STR      r0,[r9,#0]  ; g_FMC_i32ErrCode
000014  d201              BCS      |L26.26|
000016  0773              LSLS     r3,r6,#29
000018  d002              BEQ      |L26.32|
                  |L26.26|
;;;628        {
;;;629            g_FMC_i32ErrCode = -2;
00001a  f06f0001          MVN      r0,#1
;;;630            return -2;
00001e  e086              B        |L26.302|
                  |L26.32|
;;;631        }
;;;632    
;;;633        u32Len = u32Len - (u32Len % 8);         /* u32Len must be multiple of 8. */
000020  f0020307          AND      r3,r2,#7
000024  1ad4              SUBS     r4,r2,r3
;;;634    
;;;635        idx = 0;
;;;636    
;;;637        while (u32Len >= 8)
;;;638        {
;;;639            FMC->ISPADDR = u32Addr;
;;;640            FMC->MPDAT0  = pu32Buf[idx++];
;;;641            FMC->MPDAT1  = pu32Buf[idx++];
;;;642            FMC->MPDAT2  = pu32Buf[idx++];
;;;643            FMC->MPDAT3  = pu32Buf[idx++];
;;;644            FMC->ISPCMD  = FMC_ISPCMD_PROGRAM_MUL;
;;;645            FMC->ISPTRG  = FMC_ISPTRG_ISPGO_Msk;
;;;646            u32Len -= 16;
;;;647            retval += 16;
;;;648    
;;;649            for (i = 16; i < FMC_MULTI_WORD_PROG_LEN; i += 16)
;;;650            {
;;;651                tout = FMC_TIMEOUT_WRITE;
000026  4b49              LDR      r3,|L26.332|
000028  2200              MOVS     r2,#0                 ;635
;;;652                while ((tout-- > 0) && (FMC->MPSTS & (FMC_MPSTS_D0_Msk | FMC_MPSTS_D1_Msk))) {}
;;;653                if (tout <= 0)
;;;654                {
;;;655                    g_FMC_i32ErrCode = -1;
00002a  f04f3aff          MOV      r10,#0xffffffff
00002e  f8d3c000          LDR      r12,[r3,#0]           ;639
000032  f44f7e00          MOV      lr,#0x200             ;649
000036  270a              MOVS     r7,#0xa               ;651
000038  4b45              LDR      r3,|L26.336|
00003a  e081              B        |L26.320|
                  |L26.60|
00003c  605e              STR      r6,[r3,#4]            ;639
00003e  f8515022          LDR      r5,[r1,r2,LSL #2]     ;640
000042  f8c35080          STR      r5,[r3,#0x80]         ;640
000046  1c52              ADDS     r2,r2,#1              ;640
000048  f8515022          LDR      r5,[r1,r2,LSL #2]     ;641
00004c  f8c35084          STR      r5,[r3,#0x84]         ;641
000050  1c52              ADDS     r2,r2,#1              ;641
000052  f8515022          LDR      r5,[r1,r2,LSL #2]     ;642
000056  f8c35088          STR      r5,[r3,#0x88]         ;642
00005a  1c52              ADDS     r2,r2,#1              ;642
00005c  f8515022          LDR      r5,[r1,r2,LSL #2]     ;643
000060  f8c3508c          STR      r5,[r3,#0x8c]         ;643
000064  2527              MOVS     r5,#0x27              ;644
000066  60dd              STR      r5,[r3,#0xc]          ;644
000068  2501              MOVS     r5,#1                 ;645
00006a  611d              STR      r5,[r3,#0x10]         ;645
00006c  3010              ADDS     r0,r0,#0x10           ;649
00006e  1c52              ADDS     r2,r2,#1              ;649
000070  f04f0b10          MOV      r11,#0x10             ;649
000074  f1b40410          SUBS.W   r4,r4,#0x10           ;649
                  |L26.120|
000078  fbbcf5f7          UDIV     r5,r12,r7             ;651
00007c  ea5f0545          LSLS.W   r5,r5,#1              ;651
                  |L26.128|
000080  f1b50800          SUBS     r8,r5,#0              ;652
000084  f1a50501          SUB      r5,r5,#1              ;652
000088  dd04              BLE      |L26.148|
00008a  f8d380c0          LDR      r8,[r3,#0xc0]         ;652
00008e  f0180f30          TST      r8,#0x30              ;652
000092  d1f5              BNE      |L26.128|
                  |L26.148|
000094  2d00              CMP      r5,#0                 ;653
000096  dd49              BLE      |L26.300|
;;;656                    return -1;
;;;657                }
;;;658                if (!(FMC->MPSTS & FMC_MPSTS_MPBUSY_Msk))
000098  f8d350c0          LDR      r5,[r3,#0xc0]
00009c  07ed              LSLS     r5,r5,#31
00009e  d033              BEQ      |L26.264|
;;;659                {
;;;660                    /* printf("    [WARNING] busy cleared after D0D1 cleared!\n"); */
;;;661                    break;
;;;662                }
;;;663    
;;;664                if (u32Len < 8)
0000a0  2c08              CMP      r4,#8
0000a2  d331              BCC      |L26.264|
;;;665                    break;
;;;666    
;;;667                FMC->MPDAT0 = pu32Buf[idx++];
0000a4  f8515022          LDR      r5,[r1,r2,LSL #2]
0000a8  f8c35080          STR      r5,[r3,#0x80]
0000ac  1c52              ADDS     r2,r2,#1
;;;668                FMC->MPDAT1 = pu32Buf[idx++];
0000ae  f8515022          LDR      r5,[r1,r2,LSL #2]
0000b2  f8c35084          STR      r5,[r3,#0x84]
;;;669                retval += 8;
;;;670                u32Len -= 8;
;;;671    
;;;672                tout = FMC_TIMEOUT_WRITE;
0000b6  fbbcf5f7          UDIV     r5,r12,r7
0000ba  006d              LSLS     r5,r5,#1
0000bc  3008              ADDS     r0,r0,#8
0000be  1c52              ADDS     r2,r2,#1
0000c0  f1b40408          SUBS.W   r4,r4,#8
                  |L26.196|
;;;673                while ((tout-- > 0) && (FMC->MPSTS & (FMC_MPSTS_D2_Msk | FMC_MPSTS_D3_Msk))) {}
0000c4  f1b50800          SUBS     r8,r5,#0
0000c8  f1a50501          SUB      r5,r5,#1
0000cc  dd04              BLE      |L26.216|
0000ce  f8d380c0          LDR      r8,[r3,#0xc0]
0000d2  f0180fc0          TST      r8,#0xc0
0000d6  d1f5              BNE      |L26.196|
                  |L26.216|
;;;674                if (tout <= 0)
0000d8  2d00              CMP      r5,#0
0000da  dd27              BLE      |L26.300|
;;;675                {
;;;676                    g_FMC_i32ErrCode = -1;
;;;677                    return -1;
;;;678                }
;;;679                if (!(FMC->MPSTS & FMC_MPSTS_MPBUSY_Msk))
0000dc  f8d350c0          LDR      r5,[r3,#0xc0]
0000e0  07ed              LSLS     r5,r5,#31
0000e2  d028              BEQ      |L26.310|
;;;680                {
;;;681                    /* printf("    [WARNING] busy cleared after D2D3 cleared!\n"); */
;;;682                    i += 8;
;;;683                    break;
;;;684                }
;;;685    
;;;686                if (u32Len < 8)
0000e4  2c08              CMP      r4,#8
0000e6  d30f              BCC      |L26.264|
;;;687                    break;
;;;688    
;;;689                FMC->MPDAT2 = pu32Buf[idx++];
0000e8  f8515022          LDR      r5,[r1,r2,LSL #2]
0000ec  f8c35088          STR      r5,[r3,#0x88]
0000f0  1c52              ADDS     r2,r2,#1
;;;690                FMC->MPDAT3 = pu32Buf[idx++];
0000f2  f8515022          LDR      r5,[r1,r2,LSL #2]
0000f6  f8c3508c          STR      r5,[r3,#0x8c]
0000fa  f10b0b10          ADD      r11,r11,#0x10         ;649
0000fe  3008              ADDS     r0,r0,#8              ;649
000100  1c52              ADDS     r2,r2,#1              ;649
000102  3c08              SUBS     r4,r4,#8              ;649
000104  45f3              CMP      r11,lr                ;649
000106  dbb7              BLT      |L26.120|
                  |L26.264|
;;;691                retval += 8;
;;;692                u32Len -= 8;
;;;693            }
;;;694    
;;;695            if (i != FMC_MULTI_WORD_PROG_LEN)
000108  45f3              CMP      r11,lr
00010a  d112              BNE      |L26.306|
;;;696            {
;;;697                /* printf("    [WARNING] Multi-word program interrupted at 0x%x !!\n", i); */
;;;698                return retval;
;;;699            }
;;;700    
;;;701            tout = FMC_TIMEOUT_WRITE;
00010c  fbbcf5f7          UDIV     r5,r12,r7
000110  ea5f0545          LSLS.W   r5,r5,#1
                  |L26.276|
;;;702            while ((tout-- > 0) && (FMC->MPSTS & FMC_MPSTS_MPBUSY_Msk)) {}
000114  f1b50800          SUBS     r8,r5,#0
000118  f1a50501          SUB      r5,r5,#1
00011c  dd04              BLE      |L26.296|
00011e  f8d380c0          LDR      r8,[r3,#0xc0]
000122  ea5f78c8          LSLS     r8,r8,#31
000126  d1f5              BNE      |L26.276|
                  |L26.296|
;;;703            if (tout <= 0)
000128  2d00              CMP      r5,#0
00012a  dc07              BGT      |L26.316|
                  |L26.300|
;;;704            {
;;;705                g_FMC_i32ErrCode = -1;
00012c  4650              MOV      r0,r10
                  |L26.302|
00012e  f8c90000          STR      r0,[r9,#0]  ; g_FMC_i32ErrCode
                  |L26.306|
;;;706                return -1;
;;;707            }
;;;708    
;;;709            u32Addr += FMC_MULTI_WORD_PROG_LEN;
;;;710        }
;;;711        return retval;
;;;712    }
000132  e8bd8ff0          POP      {r4-r11,pc}
                  |L26.310|
000136  f10b0b08          ADD      r11,r11,#8            ;682
00013a  e7e5              B        |L26.264|
                  |L26.316|
00013c  f5067600          ADD      r6,r6,#0x200          ;683
                  |L26.320|
000140  2c08              CMP      r4,#8                 ;637
000142  f4bfaf7b          BCS      |L26.60|
000146  e7f4              B        |L26.306|
;;;713    
                          ENDP

                  |L26.328|
                          DCD      ||.data||
                  |L26.332|
                          DCD      SystemCoreClock
                  |L26.336|
                          DCD      0x4000c000

                          AREA ||i.FMC_Write_OTP||, CODE, READONLY, ALIGN=2

                  FMC_Write_OTP PROC
;;;727      */
;;;728    int32_t FMC_Write_OTP(uint32_t otp_num, uint32_t low_word, uint32_t high_word)
000000  b5f0              PUSH     {r4-r7,lr}
;;;729    {
000002  4605              MOV      r5,r0
;;;730        int32_t  tout;
;;;731    
;;;732        g_FMC_i32ErrCode = 0;
000004  4c26              LDR      r4,|L27.160|
000006  2000              MOVS     r0,#0
;;;733    
;;;734        if (otp_num > 255UL)
000008  2dff              CMP      r5,#0xff
00000a  6020              STR      r0,[r4,#0]  ; g_FMC_i32ErrCode
00000c  d901              BLS      |L27.18|
;;;735        {
;;;736            g_FMC_i32ErrCode = -2;
00000e  1e80              SUBS     r0,r0,#2
;;;737            return -2;
000010  e03e              B        |L27.144|
                  |L27.18|
;;;738        }
;;;739    
;;;740        FMC->ISPCMD = FMC_ISPCMD_PROGRAM;
000012  4b24              LDR      r3,|L27.164|
000014  2621              MOVS     r6,#0x21
000016  60de              STR      r6,[r3,#0xc]
;;;741        FMC->ISPADDR = FMC_OTP_BASE + otp_num * 8UL;
000018  f44f1044          MOV      r0,#0x310000
00001c  eb0000c5          ADD      r0,r0,r5,LSL #3
000020  6058              STR      r0,[r3,#4]
;;;742        FMC->ISPDAT = low_word;
000022  6099              STR      r1,[r3,#8]
;;;743        FMC->ISPTRG = FMC_ISPTRG_ISPGO_Msk;
000024  2701              MOVS     r7,#1
000026  611f              STR      r7,[r3,#0x10]
;;;744    
;;;745        tout = FMC_TIMEOUT_WRITE;
000028  481f              LDR      r0,|L27.168|
00002a  f04f0c0a          MOV      r12,#0xa
00002e  6801              LDR      r1,[r0,#0]  ; SystemCoreClock
000030  fbb1f0fc          UDIV     r0,r1,r12
000034  ea4f0e40          LSL      lr,r0,#1
                  |L27.56|
;;;746        while ((tout-- > 0) && (FMC->MPSTS & FMC_MPSTS_MPBUSY_Msk)) {}
000038  f1be0000          SUBS     r0,lr,#0
00003c  f1ae0e01          SUB      lr,lr,#1
000040  dd03              BLE      |L27.74|
000042  f8d300c0          LDR      r0,[r3,#0xc0]
000046  07c0              LSLS     r0,r0,#31
000048  d1f6              BNE      |L27.56|
                  |L27.74|
;;;747        if (tout <= 0)
;;;748        {
;;;749            g_FMC_i32ErrCode = -1;
00004a  f04f30ff          MOV      r0,#0xffffffff
00004e  f1be0f00          CMP      lr,#0                 ;747
000052  dd1d              BLE      |L27.144|
;;;750            return -1;
;;;751        }
;;;752    
;;;753        if (FMC->ISPSTS & FMC_ISPSTS_ISPFF_Msk)
000054  f8d3e040          LDR      lr,[r3,#0x40]
000058  ea5f6e4e          LSLS     lr,lr,#25
00005c  d504              BPL      |L27.104|
                  |L27.94|
;;;754        {
;;;755            FMC->ISPSTS |= FMC_ISPSTS_ISPFF_Msk;
00005e  6c19              LDR      r1,[r3,#0x40]
000060  f0410140          ORR      r1,r1,#0x40
000064  6419              STR      r1,[r3,#0x40]
;;;756            g_FMC_i32ErrCode = -1;
;;;757            return -1;
000066  e013              B        |L27.144|
                  |L27.104|
;;;758        }
;;;759    
;;;760        FMC->ISPCMD = FMC_ISPCMD_PROGRAM;
000068  60de              STR      r6,[r3,#0xc]
;;;761        FMC->ISPADDR = FMC_OTP_BASE + otp_num * 8UL + 4UL;
00006a  4e10              LDR      r6,|L27.172|
00006c  eb0605c5          ADD      r5,r6,r5,LSL #3
000070  605d              STR      r5,[r3,#4]
;;;762        FMC->ISPDAT = high_word;
000072  609a              STR      r2,[r3,#8]
;;;763        FMC->ISPTRG = FMC_ISPTRG_ISPGO_Msk;
000074  611f              STR      r7,[r3,#0x10]
;;;764    
;;;765        tout = FMC_TIMEOUT_WRITE;
000076  fbb1f1fc          UDIV     r1,r1,r12
00007a  0049              LSLS     r1,r1,#1
                  |L27.124|
;;;766        while ((tout-- > 0) && (FMC->MPSTS & FMC_MPSTS_MPBUSY_Msk)) {}
00007c  1e0a              SUBS     r2,r1,#0
00007e  f1a10101          SUB      r1,r1,#1
000082  dd03              BLE      |L27.140|
000084  f8d320c0          LDR      r2,[r3,#0xc0]
000088  07d2              LSLS     r2,r2,#31
00008a  d1f7              BNE      |L27.124|
                  |L27.140|
;;;767        if (tout <= 0)
00008c  2900              CMP      r1,#0
00008e  dc01              BGT      |L27.148|
                  |L27.144|
;;;768        {
;;;769            g_FMC_i32ErrCode = -1;
;;;770            return -1;
000090  6020              STR      r0,[r4,#0]  ; g_FMC_i32ErrCode
;;;771        }
;;;772    
;;;773        if (FMC->ISPSTS & FMC_ISPSTS_ISPFF_Msk)
;;;774        {
;;;775            FMC->ISPSTS |= FMC_ISPSTS_ISPFF_Msk;
;;;776            g_FMC_i32ErrCode = -1;
;;;777            return -1;
;;;778        }
;;;779        return 0;
;;;780    }
000092  bdf0              POP      {r4-r7,pc}
                  |L27.148|
000094  6c19              LDR      r1,[r3,#0x40]         ;773
000096  0649              LSLS     r1,r1,#25             ;773
000098  d4e1              BMI      |L27.94|
00009a  2000              MOVS     r0,#0                 ;779
00009c  bdf0              POP      {r4-r7,pc}
;;;781    
                          ENDP

00009e  0000              DCW      0x0000
                  |L27.160|
                          DCD      ||.data||
                  |L27.164|
                          DCD      0x4000c000
                  |L27.168|
                          DCD      SystemCoreClock
                  |L27.172|
                          DCD      0x00310004

                          AREA ||.data||, DATA, ALIGN=2

                  g_FMC_i32ErrCode
                          DCD      0x00000000

;*** Start embedded assembler ***

#line 1 "..\\..\\..\\..\\Library\\StdDriver\\src\\fmc.c"
	AREA ||.rev16_text||, CODE
	THUMB
	EXPORT |__asm___5_fmc_c_65c03504____REV16|
#line 464 "..\\..\\..\\..\\Library\\CMSIS\\Include\\cmsis_armcc.h"
|__asm___5_fmc_c_65c03504____REV16| PROC
#line 465

 rev16 r0, r0
 bx lr
	ENDP
	AREA ||.revsh_text||, CODE
	THUMB
	EXPORT |__asm___5_fmc_c_65c03504____REVSH|
#line 479
|__asm___5_fmc_c_65c03504____REVSH| PROC
#line 480

 revsh r0, r0
 bx lr
	ENDP
	AREA ||.rrx_text||, CODE
	THUMB
	EXPORT |__asm___5_fmc_c_65c03504____RRX|
#line 666
|__asm___5_fmc_c_65c03504____RRX| PROC
#line 667

 rrx r0, r0
 bx lr
	ENDP

;*** End   embedded assembler ***
